{"version":3,"sources":["components/routing/HeaderMenu.js","apis/dexie.js","images/background.jpeg","components/routing/Welcome.js","components/routing/AuthRoute.js","images/logo.png","components/home/CardTemplate.js","components/home/GatherCard.js","images/googleTakeout1.gif","images/googleTakeout2.gif","util/tokenize.js","actions/index.js","components/gather/GatherGoogleTakeout.js","components/home/GatherCardColumn.js","components/home/ExploreCard.js","components/home/ExploreCardColumn.js","components/home/DataSquare.js","util/intersect.js","components/explore/dashboards/dashboardParts/ColoredBackgroundGrid.js","components/explore/dashboards/dashboardParts/ConfirmDeleteModal.js","components/explore/dashboards/dashboardParts/DataList.js","components/explore/dashboards/dashboardParts/QueryInput.js","components/explore/dashboards/dashboardParts/Statistics.js","components/explore/dashboards/dashboardParts/BubbleChartSpec.js","components/explore/dashboards/dashboardParts/DomainInfo.js","components/explore/dashboards/dashboardParts/DatabaseEntries.js","components/explore/dashboards/dashboardParts/BubbleChart.js","components/explore/dashboards/dashboardParts/KeyCloud.js","components/explore/dashboards/dashboardParts/ConfirmDonateModal.js","components/explore/dashboards/HistoryDashboard.js","components/explore/BrowsingHistory.js","components/explore/YoutubeHistory.js","components/explore/SearchHistory.js","components/explore/dashboards/dashboardParts/TimeLine.js","util/createColors.js","components/explore/dashboards/fun/FunFacts.js","components/explore/dashboards/GoodiesDashboard.js","components/explore/GoodiesView.js","App.js","reducers/index.js","index.js"],"names":["withRouter","items","children","location","useLocation","menuItems","map","item","index","Menu","Item","as","Link","to","path","header","disabled","active","pathname","label","Sidebar","Pushable","inverted","animation","visible","direction","size","Pusher","db","this","idb","Dexie","version","stores","meta","browsinghistory","youtube","searchhistory","datastatus","a","isWelcome","add","welcome","get","table","offset","limit","rows","count","n","toArray","ids","length","where","anyOf","delete","selection","browserdata","getTableFromIds","stats","DataFrame","withColumn","row","date","Date","getFullYear","getMonth","getDate","getHours","getMinutes","getDay","sortBy","fields","query","key","any","regex","RegExp","replace","toCollection","collection","each","field","push","id","test","primaryKeys","from","start","end","between","reverse","name","equals","modify","status","data","bulkPut","then","lastKey","console","log","catch","BulkError","e","failures","Welcome","history","useHistory","beWelcomed","checkWelcome","useEffect","Grid","textAlign","style","height","backgroundImage","background","backgroundSize","verticalAlign","Column","maxWidth","Segment","border","Header","align","Button","primary","onClick","AuthRoute","Component","componentProps","useState","loading","setLoading","hasdb","setHasdb","connect","render","props","process","CardTemplate","subname","icon","Card","centered","cursor","width","marginLeft","marginRight","Dimmer","Loader","Content","Icon","float","content","Meta","Description","GatherCard","color","statusMessage","STOPWORDS_LOOKUP","reduce","obj","sw","tokenize","text","split","filter","token","toLowerCase","setDataStatus","dataStatus","type","updateDataStatus","dispatch","getState","newDataStatus","i","findIndex","WriteToDB","setOpen","useDispatch","ref","useRef","onChangeHandler","failed","newZip","JSZip","fileblob","target","files","loadAsync","zipped","file","async","chrome","JSON","parse","writeChromeHistory","parseYoutubeHtml","writeYoutubeHistory","current","click","hidden","onChange","accept","string","nodes","DOMParser","parseFromString","querySelector","querySelectorAll","node","aList","subtitles","textContent","url","attributes","href","titleUrl","title","br","datestring","nextSibling","time","toISOString","urls","queries","URL","hostname","trim","words","word","convertTimestamp","time_usec","platform","domain","page_transition","addData","d","channel","channel_url","Math","round","GatherGoogleTakeout","open","Modal","onClose","onOpen","trigger","rel","stackable","Container","List","ordered","marginTop","marginBottom","padding","src","gt1","alt","gt2","Actions","GoogleTakeout","GatherCardColumn","lastUpdated","oldTime","currentTime","slice","ExploreCard","useSelector","state","find","Browsing","Search","Youtube","ExploreCardColumn","useLiveQuery","headerStyle","fontSize","paddingBottom","paddingTop","columnStyle","cardGroupStyle","DataSquare","logo","divided","Group","anyDone","arrays","cursors","allEqual","allMax","max","intersect","array","Array","fill","res","ColoredBackgroundGrid","zIndex","top","bottom","right","left","position","overflow","ConfirmDeleteModal","confirm","setConfirm","ask","setAsk","itemIds","handleDelete","deleteTableIds","backgroundColor","ButtonGroup","fluid","Checkbox","value","React","memo","DataList","layout","setData","setN","selectionN","setSelectionN","fetchFromDb","onBottomVisible","newdata","getTableBatch","createItem","Table","Cell","overflowY","Visibility","continuous","striped","fixed","Row","HeaderCell","charAt","toUpperCase","Body","pageSize","getTableN","QueryInput","searchOn","setSelection","search","setSearch","selectionStatus","setSelectionStatus","timer","setTimeout","searchSelection","clearTimeout","Input","getSelectionQuery","Statistics","loadingData","setLoadingData","borderRadius","margin","total_visits","max_domain","mean","num_domains","getDataFrame","group","groupBy","counts","aggregate","rename","statistics","stat","getRow","createClassFromSpec","spec","generateToken","message","concat","join","msgBuffer","TextEncoder","encode","crypto","subtle","digest","hashBuffer","hashArray","Uint8Array","b","toString","padStart","useDatabaseEntries","keyTotalObj","setKeyTotalObj","entries","setEntries","t","rawEntries","fetchData","useRawEntries","allDomains","setAllDomains","domains","cacheRef","setStatus","cache","cachedDomains","Object","keys","domainsToFetch","includes","body","fetch","method","headers","stringify","response","json","useDomainInfo","domainInfo","Set","entry","isArray","undefined","category","parent","BubbleChart","inSelection","nWords","setOutSelection","tree","selectedDatum","setSelectedDatum","filteredDatum","setFilteredDatum","values","categories","cats","keyTotal","signalListeners","signal","datum","filterDatum","popupStyle","x","y","BubbleChartSpec","actions","Image","floated","basic","extra","className","wordcloudOptions","rotations","enableOptimizations","enableTooltip","deterministic","fontFamily","fontSizes","transitionDuration","colors","KeyCloud","setKeys","setWords","prepareData","ignore","getSelectionAny","getSelection","callbacks","useCallback","onWordClick","old","newkeys","has","getWordColor","boxShadow","minWidth","minSize","options","fontStyle","Dropdown","multiple","clearable","minHeight","uniqueKeys","orderBy","sort","tables","ConfirmDonateModal","setCounts","getCounts","handleDonate","tableToJson","Promise","all","donated","gridStyle","HistoryDashboard","cloudKey","querySelection","setQuerySelection","domainSelection","setDomainSelection","keyInSelection","setKeyOutSelection","confirmDonate","setConfirmDonate","display","columns","paddingLeft","paddingRight","SEARCHON","LAYOUT","BrowsingHistory","YoutubeHistory","SearchHistory","COLORS","color1","color2","color3","heatmap","Rainbow","setSpectrum","setNumberRange","colourAt","createColors","ZEROCOLOR","LEGENDS","anchor","translateY","itemCount","itemWidth","itemHeight","itemsSpacing","itemDirection","MARGIN","THEME","textColor","TimeLine","days","setDays","dayRange","setDayRange","day","getSelectionRange","formatDate","secondary","min","emptyColor","some","yearSpacing","monthSpacing","monthBorderColor","dayBorderWidth","dayBorderColor","legends","onContextMenu","midnightMorning","setHours","midnightEvening","theme","dayTotalObj","weekday","dateOrdered","first","minDate","last","maxDate","setDate","dayTotal","addZ","facts","dayCount","m","mostBusyDay","dayName","toLocaleDateString","timeGroup","minTime","maxTime","avgmintime","avgmaxtime","toLocaleTimeString","hour","minute","mostVisits","mV","mostVisitsDayName","year","month","maxDiff","d1","DateTime","fromJSDate","diffInDays","diff","mid_time","floor","FunFacts","most_active_day","typical_start","typical_end","most_visits_day","most_visits_in_1_day","most_days_between_visits","middle_point","GoodiesDashboard","setKeyInSelection","keyOutSelection","timeInSelection","setTimeInSelection","timeOutSelection","setTimeOutSelection","frameBorder","class","allowFullScreen","GoodiesView","App","exact","rootReducer","combineReducers","action","store","createStore","applyMiddleware","thunk","ReactDOM","StrictMode","document"],"mappings":"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","file":"static/js/main.71a5d199.chunk.js","sourcesContent":["import React from \"react\";\nimport { Menu, Sidebar } from \"semantic-ui-react\";\nimport { Link, withRouter, useLocation } from \"react-router-dom\";\n\nconst HeaderMenu = ({ items, children }) => {\n  // This header menu is super sneaky.\n  // It's actually not meant to be seen.\n  // But it's nice to be able to turn it on (set visible to true) when developing\n  // (and it now handles the routing)\n\n  const location = useLocation();\n\n  const menuItems = items.map((item, index) => {\n    return (\n      <Menu.Item\n        key={\"item-\" + index}\n        index={index}\n        as={Link}\n        to={item.path}\n        header={index === 0}\n        disabled={false}\n        active={item.path === location.pathname}\n      >\n        {item.label}\n      </Menu.Item>\n    );\n  });\n\n  return (\n    <Sidebar.Pushable>\n      <Sidebar as={Menu} inverted animation=\"push\" visible={false} direction={\"top\"} size=\"mini\">\n        {menuItems}\n      </Sidebar>\n      <Sidebar.Pusher>{children}</Sidebar.Pusher>\n    </Sidebar.Pushable>\n  );\n};\n\nexport default withRouter(HeaderMenu);\n","import { DataFrame } from \"dataframe-js\";\nimport Dexie from \"dexie\";\n//import hash from \"object-hash\";\n\n/**\n * Creates an instance of AnnotationDB, which is just a dexie db with some bells and whistles.\n */\nclass AnnotationDB {\n  constructor() {\n    // Dexie automatically checks whether a db with this name exists. If it does,\n    // it opens the existing one, if it doesn't, it creates a new one.\n    this.idb = new Dexie(\"DataDonationsLab\"); // idb = indexedDB\n\n    // the following 2 lines are only for developing\n    // if enabled (i.e. not commented), the db resets every time the app is started (also when refreshing)\n    // this.idb.delete();\n    // this.idb = new Dexie(\"DataDonationsLab\");\n\n    this.idb.version(2).stores({\n      meta: \"welcome\", // this just serves to keep track of whether db was 'created' via the welcome component. Eventually, this would be a good place to add authentication / token validation\n      browsinghistory: \"id++, &[url+date], [domain+date], domain, date\", // id++ auto increments ; &[url+date] is unique compound key\n      youtube: \"id++, &[url+date], channel, date\",\n      searchhistory: \"id++, &[query+date], *word, date\", // *word is a multientry index that takes an array of words\n      datastatus: \"name\", // names should be the name of a table (browsinghistory, youtube, etc.). Used to keep track of status\n    });\n  }\n\n  // META\n  /** just serves to indicate that user has accepted conditions at welcome screen */\n  async welcome() {\n    if (!(await this.isWelcome())) this.idb.meta.add({ welcome: 1 });\n    return null;\n  }\n  async isWelcome() {\n    return this.idb.meta.get(1);\n  }\n\n  // ANY TABLE DATA\n  async getTableBatch(table, offset, limit) {\n    if (offset !== null && offset < 0) return null;\n    let rows = await this.idb.table(table);\n    const n = await rows.count();\n    if (offset !== null && offset > n - 1) return null;\n    if (limit !== null) rows = rows.offset(offset).limit(limit);\n    return rows.toArray();\n  }\n\n  async getTableFromIds(table, ids) {\n    if (ids.length === 0) return [];\n    return await this.idb.table(table).where(\"id\").anyOf(ids).toArray();\n  }\n\n  async getTableN(table) {\n    let rows = await this.idb.table(table);\n    return rows.count();\n  }\n\n  async deleteTableIds(table, ids) {\n    if (ids.length === 0) return [];\n    await this.idb.table(table).where(\"id\").anyOf(ids).delete();\n  }\n\n  async getDataFrame(selection) {\n    let browserdata = [];\n\n    if (selection !== null) {\n      browserdata = await db.getTableFromIds(\"browsinghistory\", selection);\n    } else {\n      browserdata = await this.idb.table(\"browsinghistory\").toArray();\n    }\n\n    let stats = new DataFrame(browserdata);\n    stats = stats.withColumn('dateOnly', (row) => {\n      const date = row.get(\"date\");\n      return new Date(date.getFullYear(), date.getMonth(), date.getDate());\n    });\n    stats = stats.withColumn('time', (row) => {\n      const date = row.get(\"date\");\n      return new Date(0,0,0,date.getHours(), date.getMinutes(), 0);\n    });\n    stats = stats.withColumn(\"day\", (row) => (row.get(\"date\").getDay()));\n    stats = stats.sortBy(\"date\");\n\n    return stats;\n  }\n\n  /**\n   * text search data in table\n   * @param {string} table  Name of a table\n   * @param {array} fields  Names of the fields to search\n   * @param {string} query  A string to search for\n   * @param {string} key    Optionally, filter on an indexed 'key' before performing the fulltext search.\n   * @param {array} any     If key is used, any should be an array of values\n   * @returns\n   */\n  async getSelectionQuery(table, fields, query, key, any) {\n    // table: what table to search\n    // fields: what columns to search\n    // query: direct text match\n    // key, any: optionally, filter on an indexed key, where any is an array of values\n    let regex = null;\n    if (query !== \"\") regex = new RegExp(query.replace(/[-/\\\\^$*+?.()|[\\]{}]/, \"\\\\$&\"), \"i\");\n    let rows = await this.idb.table(table);\n\n    let selection = [];\n    let collection = any == null ? await rows.toCollection() : await rows.where(key).anyOf(any);\n\n    await collection.each((row) => {\n      for (let field of fields) {\n        if (regex === null) {\n          selection.push(row.id);\n          return;\n        }\n        if (regex.test(row[field])) {\n          selection.push(row.id);\n          return;\n        }\n      }\n    });\n    return selection;\n  }\n\n  async getSelectionAny(table, key, any) {\n    let rows = await this.idb.table(table);\n    return await rows.where(key).anyOf(any).primaryKeys();\n  }\n\n  async getSelectionRange(table, key, from, to) {\n    let rows = await this.idb.table(table);\n\n    const start = from || new Date(1000, 1, 1);\n    const end = to || new Date(3000, 1, 1);\n\n    return await rows.where(key).between(start, end, true, true).reverse().primaryKeys();\n  }\n\n  // DATA STATUS\n  async dataStatus(name) {\n    return this.idb.datastatus.get(name);\n  }\n\n  async updateDataStatus(name) {\n    // note that status is always set to finished.\n    // whenever the datastatus table is updated, it its written to the dataStatus state (redux)\n    // This way the 'loading' status can be triggered via dispatch, and is set to finished when the update is finished\n    const current = await this.idb.datastatus.get(name);\n    if (current) {\n      this.idb.datastatus\n        .where(\"name\")\n        .equals(name)\n        .modify({ date: new Date(), status: \"finished\" });\n    } else {\n      this.idb.datastatus.add({ name, date: new Date(), status: \"finished\" });\n    }\n  }\n\n  async addData(data, table) {\n    // The unique compound index &[url+date] ensures no duplicates\n    // Dexie will throw an error for this, but apparently you can catch it\n    // and then dexie will continue uploading the other items\n    // (https://dexie.org/docs/Table/Table.bulkPut())\n    this.idb\n      .table(table)\n      .bulkPut(data)\n      .then((lastKey) => {\n        console.log(\"uploaded all data items\");\n      })\n      .catch(Dexie.BulkError, (e) => {\n        console.log(`Failed to upload ${e.failures.length} data items`);\n      });\n  }\n}\n\nconst db = new AnnotationDB();\nexport default db;\n","export default __webpack_public_path__ + \"static/media/background.eb5e36bf.jpeg\";","import React, { useEffect } from \"react\";\n\nimport db from \"apis/dexie\";\nimport { useHistory } from \"react-router-dom\";\nimport { Grid, Button, Header, Segment } from \"semantic-ui-react\";\nimport background from \"images/background.jpeg\";\n\n/**\n * This component only appears the first time users visit,\n * or if they are away so long that the indexedDB has been cleaned.\n * In time, this page should clearly list the terms and conditions.\n */\nconst Welcome = ({ items }) => {\n  const history = useHistory();\n\n  const beWelcomed = async (checkWelcome) => {\n    if (checkWelcome) {\n      const iswelcome = await db.isWelcome();\n      if (!iswelcome) return null;\n    }\n    try {\n      await db.welcome();\n      history.push(items[0].path);\n    } catch (e) {}\n  };\n\n  useEffect(() => {\n    beWelcomed(true);\n  });\n\n  return (\n    <Grid\n      inverted\n      textAlign=\"center\"\n      style={{\n        height: \"100vh\",\n        backgroundImage: `url(${background})`,\n        backgroundSize: \"100% 100%\",\n      }}\n      verticalAlign=\"middle\"\n    >\n      <Grid.Column style={{ maxWidth: 600 }}>\n        <Segment style={{ border: 0 }}>\n          <Header as=\"h2\">Welcome to the Digital Footprints Lab!</Header>\n          <p align=\"justified\">\n            This application let's you collect and explore your own digital traces. All the data is\n            stored and processed on your own device, and cannot be seen by anyone, so that you are\n            free to contemplate your life choices in solitude.\n          </p>\n          <p align=\"justified\">\n            We do, however, kindly ask you to anonymously donate some parts of this data for\n            scientific research. Specifically, we are interested in how you seek, consume and share\n            news articles. The data will be used for non-commercial research by a select group of\n            researchers at Dutch Universities.\n          </p>\n          <Button primary onClick={() => beWelcomed(false)}>\n            Great, let's get started!\n          </Button>\n        </Segment>\n      </Grid.Column>\n    </Grid>\n  );\n};\n\nexport default Welcome;\n","import React, { useState } from \"react\";\nimport { Route, Redirect } from \"react-router\";\nimport db from \"apis/dexie\";\n\n/**\n * Handles authentication (which at the moment is just accepting the welcome message)\n * Redirects to the welcome pages if the condition in connect is not met.\n */\nconst AuthRoute = ({ Component, ...componentProps }) => {\n  const [loading, setLoading] = useState(true);\n  const [hasdb, setHasdb] = useState(false);\n  // the weird trick for passing on componentProps is basically\n  // redundant with Redux, but leaving it intact just in case\n\n  const connect = async () => {\n    if (await db.isWelcome()) {\n      setHasdb(true);\n    } else {\n      setHasdb(false);\n    }\n    setLoading(false);\n  };\n\n  connect();\n\n  return (\n    <Route\n      {...componentProps}\n      render={(props) =>\n        loading ? (\n          <div>loading...</div>\n        ) : hasdb ? (\n          <Component {...componentProps} {...props} />\n        ) : (\n          <Redirect to={`${process.env.PUBLIC_URL}/`} />\n        )\n      }\n    />\n  );\n};\n\nexport default AuthRoute;\n","export default __webpack_public_path__ + \"static/media/logo.fc0d5b24.png\";","import React from \"react\";\nimport { Card, Dimmer, Icon, Loader } from \"semantic-ui-react\";\n\nconst CardTemplate = ({ children, name, subname, icon, onClick, loading }) => {\n  return (\n    <Card\n      centered\n      style={{\n        cursor: \"pointer\",\n        width: \"100%\",\n        marginLeft: \"2em\",\n        marginRight: \"2em\",\n        background: \"#ffffff00\",\n      }}\n      onClick={onClick}\n    >\n      <Dimmer active={loading === \"loading\"}>\n        <Loader />\n      </Dimmer>\n      <Card.Content style={{ background: \"#ffffff\" }}>\n        <Icon size=\"huge\" name={icon} style={{ float: \"right\" }} />\n        <Card.Header content={name} />\n        <Card.Meta content={subname} />\n\n        <Card.Description>{children}</Card.Description>\n      </Card.Content>\n    </Card>\n  );\n};\n\nexport default CardTemplate;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Icon } from \"semantic-ui-react\";\nimport CardTemplate from \"./CardTemplate\";\n\nconst propTypes = {\n  /** The name of the platform from which to gather the data */\n  name: PropTypes.string.isRequired,\n  /** A subname, for extra info */\n  subname: PropTypes.string.isRequired,\n  /** The name of an Icon from semantic ui, see https://semantic-ui.com/elements/icon.html  */\n  icon: PropTypes.string.isRequired,\n  /** Event handler for clicks. Not strictly necessary, because the card can also be used as a trigger (as in GatherGoogleTakeout) */\n  onClick: PropTypes.func,\n  /** String indicating loading status */\n  loading: PropTypes.string.isRequired,\n};\n\n/**\n * The template for generating GatherCards.\n * These are the cards in the Gather column on the home page.\n */\nconst GatherCard = ({ name, subname, icon, onClick, loading }) => {\n  const statusMessage = (loading) => {\n    if (loading === \"failed\")\n      return (\n        <>\n          <Icon name=\"close\" color=\"red\" />\n          <i>Something went wrong :(</i>\n        </>\n      );\n    if (loading === \"finished\")\n      return (\n        <>\n          <Icon name=\"checkmark\" color=\"green\" />\n          <i>Data succesfully imported</i>\n        </>\n      );\n    return <i>Click here to gather data</i>;\n  };\n\n  return (\n    <CardTemplate name={name} subname={subname} icon={icon} onClick={onClick} loading={loading}>\n      {statusMessage(loading)}\n    </CardTemplate>\n  );\n};\n\nGatherCard.propTypes = propTypes;\nexport default GatherCard;\n","export default __webpack_public_path__ + \"static/media/googleTakeout1.d43cb755.gif\";","export default __webpack_public_path__ + \"static/media/googleTakeout2.97152dfa.gif\";","const STOPWORDS = [\"and\", \"or\", \"not\", \"the\", \"it\"]; // etc\nconst STOPWORDS_LOOKUP = STOPWORDS.reduce((obj, sw) => {\n  obj[sw] = true;\n  return obj;\n}, {});\n\n/**\n * Quick and dirty word tokenization, with very basic stopword filtering\n * Probably should replace this with a proper lightweight NLP package\n * @param {string} text The text to tokenize\n * @returns An array of the (filtered) tokens\n */\nconst tokenize = (text) => {\n  return text.split(/\\W+/).filter((token) => {\n    token = token.toLowerCase();\n    if (token.length <= 1) return false; // also drop single chars and empty\n    if (STOPWORDS_LOOKUP[token]) return false;\n    return true;\n  });\n};\n\nexport default tokenize;\n","export const setDataStatus = (dataStatus) => {\n  return {\n    type: \"SET_DATA_STATUS\",\n    dataStatus,\n  };\n};\n\nexport const updateDataStatus = (name, status) => {\n  return (dispatch, getState) => {\n    const { dataStatus } = getState();\n    const newDataStatus = [...dataStatus];\n    const i = newDataStatus.findIndex((data) => data.name === name);\n    if (i < 0) {\n      newDataStatus.push({ name, date: null, status: status });\n    } else {\n      newDataStatus[i] = { ...newDataStatus[i], status: status };\n    }\n    dispatch(setDataStatus(newDataStatus));\n  };\n};\n","import React, { useRef, useState } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { Button, Container, Grid, Header, List, Modal, Segment } from \"semantic-ui-react\";\nimport gt1 from \"images/googleTakeout1.gif\";\nimport gt2 from \"images/googleTakeout2.gif\";\nimport db from \"apis/dexie\";\nimport tokenize from \"util/tokenize\";\n\nimport JSZip from \"jszip\";\nimport { useDispatch } from \"react-redux\";\nimport { updateDataStatus } from \"actions\";\n\n// This script handles everything related to importing Google Takeout data\n// It should serve as an example for implementing other platforms\n// (and could probably do with a makeover)\n\nconst propTypes = {\n  /** A <GatherCard/>, which then serves as the trigger for the modal when clicked on */\n  children: PropTypes.element,\n  /** callback function for setting the loading status */\n  setLoading: PropTypes.func,\n};\n\n/**\n * The modal that opens when the Google Takeout Gather card is clicked.\n */\nconst GatherGoogleTakeout = ({ children, setLoading }) => {\n  const [open, setOpen] = useState(false);\n\n  return (\n    <Modal\n      onClose={() => setOpen(false)}\n      onOpen={() => setOpen(true)}\n      open={open}\n      trigger={children}\n    >\n      <Modal.Header>Google Takeout</Modal.Header>\n      <Modal.Content>\n        <Modal.Description>\n          <p>\n            As you can imagine, Google has a lot of data about many people, and probably about you\n            as well. A lesser known fact is that the data is still yours, and Google is legally\n            required to give you access to it. You can obtain this data via{\" \"}\n            <a href=\"https://takeout.google.com/\" target=\"_blank\" rel=\"noopener noreferrer\">\n              Google Takeout.\n            </a>{\" \"}\n          </p>\n          <br />\n\n          <Grid stackable>\n            <Grid.Column width={16}>\n              <Container>\n                <Header>How do I order takeout from Google?</Header>\n\n                <List ordered>\n                  <List.Item>\n                    First, open the{\" \"}\n                    <a href=\"https://takeout.google.com/\" target=\"_blank\" rel=\"noopener noreferrer\">\n                      Google Takeout\n                    </a>{\" \"}\n                    website (the link opens in a new tab or window).\n                  </List.Item>\n                  <List.Item>\n                    Find the list under <b>Create a new export</b>. Unselect everything, and then\n                    only select <b>Chrome</b> and <b>Youtube</b>\n                  </List.Item>\n\n                  <List.Item>\n                    For Youtube we also filter out some content. Click on{\" \"}\n                    <b>All Youtube data included</b>, and make sure to select only <b>History</b>.\n                    Then click on <b>Multiple formats</b> and for <b>History</b> change <b>HTML</b>{\" \"}\n                    to <b>JSON</b>\n                  </List.Item>\n                  <Grid stackable style={{ marginTop: \"1em\", marginBottom: \"1em\" }}>\n                    <Grid.Column width={8}>\n                      <Header textAlign=\"center\">Step 2</Header>\n                      <Segment style={{ padding: 0 }}>\n                        <img width=\"100%\" src={gt1} alt=\"loading...\" />\n                      </Segment>\n                    </Grid.Column>\n                    <Grid.Column width={8}>\n                      <Header textAlign=\"center\">Step 3</Header>\n                      <Segment style={{ padding: 0 }}>\n                        <img width=\"100%\" src={gt2} alt=\"loading...\" />\n                      </Segment>\n                    </Grid.Column>\n                  </Grid>\n                  <List.Item>\n                    Finally, click <b>Next step</b>. Here you can click <b>Create export</b> (the\n                    default settings are good). If you followed the selection steps, this will only\n                    be a few megabytes, and Google will send you the download link in a few minutes.\n                    This link will give you a <b>zip</b> file, that you can upload here:\n                  </List.Item>\n                </List>\n                <br />\n                <WriteToDB setOpen={setOpen} setLoading={setLoading} />\n              </Container>\n            </Grid.Column>\n          </Grid>\n        </Modal.Description>\n      </Modal.Content>\n      <Modal.Actions>\n        <Button onClick={() => setOpen(false)}>Cancel</Button>\n      </Modal.Actions>\n    </Modal>\n  );\n};\n\nconst WriteToDB = ({ setOpen, setLoading }) => {\n  const dispatch = useDispatch();\n  const ref = useRef();\n\n  const onChangeHandler = async (e) => {\n    dispatch(updateDataStatus(\"browsinghistory\", \"loading\"));\n    dispatch(updateDataStatus(\"searchhistory\", \"loading\"));\n    dispatch(updateDataStatus(\"youtube\", \"loading\"));\n\n    let failed = false;\n    try {\n      setLoading(\"loading\");\n      setOpen(false);\n      let newZip = new JSZip();\n      let fileblob = e.target.files[0];\n\n      const zipped = await newZip.loadAsync(fileblob);\n\n      try {\n        let chrome = await zipped.file(\"Takeout/Chrome/BrowserHistory.json\").async(\"text\");\n        chrome = JSON.parse(chrome);\n        writeChromeHistory(chrome[\"Browser History\"]);\n      } catch (e) {\n        failed = true;\n        dispatch(updateDataStatus(\"searchhistory\", \"failed\"));\n        dispatch(updateDataStatus(\"browsinghistory\", \"failed\"));\n      }\n\n      try {\n        let youtube;\n        const isJSON = zipped.file(\"Takeout/YouTube and YouTube Music/history/watch-history.json\");\n        if (isJSON) {\n          youtube = await zipped\n            .file(\"Takeout/YouTube and YouTube Music/history/watch-history.json\")\n            .async(\"text\");\n          youtube = JSON.parse(youtube);\n        } else {\n          youtube = await zipped\n            .file(\"Takeout/YouTube and YouTube Music/history/watch-history.html\")\n            .async(\"text\");\n          youtube = parseYoutubeHtml(youtube);\n        }\n        writeYoutubeHistory(youtube);\n      } catch (e) {\n        console.log(e);\n        failed = true;\n        dispatch(updateDataStatus(\"youtube\", \"failed\"));\n      }\n    } catch (e) {\n      setLoading(\"failed\");\n    }\n    setLoading(failed ? \"failed\" : \"finished\");\n  };\n\n  return (\n    <div style={{ textAlign: \"center\" }}>\n      <Button primary onClick={() => ref.current.click()}>\n        Import Google Takeout\n      </Button>\n      <input\n        ref={ref}\n        type=\"file\"\n        name=\"file\"\n        hidden\n        onChange={onChangeHandler}\n        accept=\"application/zip\"\n      />\n    </div>\n  );\n};\n\nconst parseYoutubeHtml = (string) => {\n  const doc = new DOMParser().parseFromString(string, \"text/html\");\n  const nodes = doc.querySelector(\".mdl-grid\").querySelectorAll(\".mdl-grid\");\n\n  const items = [];\n  for (let i = 0; i < nodes.length; i++) {\n    const node = nodes[i];\n    const aList = node.querySelectorAll(\"a\");\n\n    const item = {};\n    if (aList.length === 2) {\n      item.subtitles = { name: aList[1].textContent, url: aList[1].attributes.href.textContent };\n    }\n    item.titleUrl = aList[0].attributes.href.textContent;\n    item.title = aList[0].textContent;\n\n    const br = node.children[1].querySelectorAll(\"br\");\n    const datestring = br[br.length - 1].nextSibling.textContent;\n    const date = new Date(Date.parse(datestring.replace(\"CEST\", \"GMT+0200\")));\n    item.time = date.toISOString();\n    items.push(item);\n  }\n  return items;\n};\n\nconst writeChromeHistory = async (history) => {\n  let urls = [];\n  let queries = [];\n\n  for (let item of history) {\n    let url = new URL(item.url);\n    if (url.hostname + url.pathname === \"www.google.com/search\") {\n      const query = item.title.replace(\"- Google Search\", \"\").trim();\n      let words = tokenize(query);\n      queries.push({\n        query: query,\n        word: words,\n        date: convertTimestamp(item.time_usec),\n        platform: \"Chrome\",\n      });\n      continue;\n    }\n\n    urls.push({\n      url: item.url,\n      title: item.title,\n      domain: url.hostname,\n      platform: \"Chrome\",\n      date: convertTimestamp(item.time_usec),\n      page_transition: item.page_transition,\n    });\n  }\n\n  await db.addData(queries, \"searchhistory\");\n  await db.addData(urls, \"browsinghistory\");\n  await db.updateDataStatus(\"browsinghistory\", \"finished\");\n  await db.updateDataStatus(\"searchhistory\", \"finished\");\n};\n\nconst writeYoutubeHistory = async (history) => {\n  let d = history.map((item) => {\n    return {\n      url: item.titleUrl,\n      title: item.title,\n      date: new Date(item.time),\n      channel: item.subtitles ? item.subtitles.name : \"channel removed\",\n      channel_url: item.subtitles ? item.subtitles.url : \"channel removed\",\n    };\n  });\n  // for (let i = 0; i < d.length; i++) {\n  //   console.log(d[i]);\n  //   await db.addData([d[i]], \"youtube\");\n\n  // }\n  await db.addData(d, \"youtube\");\n  await db.updateDataStatus(\"youtube\", \"finished\");\n};\n\nconst convertTimestamp = (time) => {\n  // seems to be in microseconds since epoch\n  return new Date(Math.round(time / 1000));\n};\n\nGatherGoogleTakeout.propTypes = propTypes;\nexport default GatherGoogleTakeout;\n","import React, { useState } from \"react\";\nimport GatherCard from \"./GatherCard\";\nimport GatherGoogleTakeout from \"components/gather/GatherGoogleTakeout\";\n\n// Like explorecards, this creates the gather cards\n// These are a bit more tricky because these create modals (instead of routing to a new page)\n// The gather components therefore take the GatherCard as a child (used to trigger the modal)\n// and a setLoading prop that reports the loading status of the gather script. (see GatherGoogleTakeout)\n\n/**\n * Returns all gather cards to be rendered on the home page.\n */\nconst GatherCardColumn = () => {\n  // Currently only uses google takeout, so it looks silly\n  return <GoogleTakeout />;\n};\n\n/**\n * Renders the gather card for Google Takeout\n */\nconst GoogleTakeout = () => {\n  const [loading, setLoading] = useState(\"idle\");\n\n  // yes, it looks weird that the GatherCard is a child of the GatherGoogleTakeout\n  // the reason is that GatherGoogleTakeout is a popup, and the GatherCard is the trigger\n  return (\n    <GatherGoogleTakeout setLoading={setLoading}>\n      <GatherCard\n        name={\"Google\"}\n        subname={\"takeout.google.com\"}\n        icon={\"google\"}\n        loading={loading}\n      />\n    </GatherGoogleTakeout>\n  );\n};\n\nexport default GatherCardColumn;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { useSelector } from \"react-redux\";\nimport { useHistory } from \"react-router\";\nimport CardTemplate from \"./CardTemplate\";\n\nconst propTypes = {\n  /** The name of the type of data to explore. */\n  name: PropTypes.string.isRequired,\n  /** A subname, for extra info */\n  subname: PropTypes.string.isRequired,\n  /** The name of an Icon from semantic ui, see https://semantic-ui.com/elements/icon.html  */\n  icon: PropTypes.string.isRequired,\n  /** The name of the table used for this data type in indexedDB */\n  table: PropTypes.string.isRequired,\n};\n\n/**\n * The template for generating ExploreCards.\n * These are the cards in the Explore column on the home page.\n */\nconst ExploreCard = ({ name, subname, icon, table }) => {\n  const history = useHistory();\n  const dataStatus = useSelector((state) => {\n    return state.dataStatus.find((data) => data.name === table);\n  });\n  if (!dataStatus) return null;\n  if (dataStatus.status === \"failed\" && !dataStatus.date) return null;\n\n  const onClick = () => {\n    history.push(table);\n  };\n\n  return (\n    <CardTemplate\n      name={name}\n      subname={subname}\n      icon={icon}\n      onClick={onClick}\n      loading={dataStatus.status}\n    >\n      <i>{lastUpdated(dataStatus.date)}</i>\n    </CardTemplate>\n  );\n};\n\nconst lastUpdated = (date) => {\n  if (!date) return \"Data not yet gathered\";\n  const oldTime = date.toISOString();\n  const currentTime = new Date().toISOString();\n\n  // if different day, show day\n  if (oldTime.slice(0, 10) !== currentTime.slice(0, 10))\n    return `Data imported on ${oldTime.slice(0, 10)}`;\n\n  // otherwise show time\n  return \"Data imported today\";\n};\n\nExploreCard.propTypes = propTypes;\nexport default ExploreCard;\n","import { useLiveQuery } from \"dexie-react-hooks\";\nimport React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { setDataStatus } from \"actions\";\nimport db from \"apis/dexie\";\nimport ExploreCard from \"./ExploreCard\";\n\n/**\n * Returns all explore cards to be rendered on the home page.\n */\nconst ExploreCardColumn = () => {\n  const dispatch = useDispatch();\n\n  // useLiveQuery monitors IndexedDb and sends updates to the redux store\n  // this is used to display the status of the cards\n  useLiveQuery(async () => {\n    const dataStatus = await db.idb.datastatus.toArray();\n    dispatch(setDataStatus(dataStatus));\n  });\n\n  return (\n    <>\n      <Browsing />\n      <Search />\n      <Youtube />\n    </>\n  );\n};\n\nconst Browsing = () => {\n  return (\n    <ExploreCard\n      name={\"Browsing history\"}\n      subname={\"What pages did you visit?\"}\n      icon={\"history\"}\n      table={\"browsinghistory\"}\n    />\n  );\n};\n\nconst Search = () => {\n  return (\n    <ExploreCard\n      name={\"Google searches\"}\n      subname={\"What did you search for?\"}\n      icon={\"search\"}\n      table={\"searchhistory\"}\n    />\n  );\n};\n\nconst Youtube = () => {\n  return (\n    <ExploreCard\n      name={\"Youtube\"}\n      subname={\"Channels and videos\"}\n      icon={\"youtube\"}\n      table={\"youtube\"}\n    />\n  );\n};\n\nexport default ExploreCardColumn;\n","import React from \"react\";\nimport { Card, Grid, Header, Icon } from \"semantic-ui-react\";\nimport logo from \"images/logo.png\";\n\nimport GatherCardColumn from \"./GatherCardColumn\";\nimport ExploreCardColumn from \"./ExploreCardColumn\";\n\nconst headerStyle = {\n  color: \"white\",\n  fontSize: \"20px\",\n  filter: \"none\",\n  background: \"#00000078\",\n  paddingBottom: \"0.3em\",\n  paddingTop: \"0.4em\",\n};\n\nconst columnStyle = {\n  marginBottom: \"1em\",\n};\n\nconst cardGroupStyle = {\n  marginTop: \"2em\",\n};\n\nconst DataSquare = () => {\n  return (\n    <div style={{ height: \"102vh\", backgroundImage: `url(${logo})`, backgroundSize: \"100% 100%\" }}>\n      <Grid stackable divided centered style={{ paddingTop: \"4em\" }}>\n        <Grid.Column textAlign=\"center\" width={5} style={columnStyle}>\n          <Header style={headerStyle}>\n            <Icon name=\"cloud download\" />\n            Gather\n          </Header>\n\n          <Card.Group style={cardGroupStyle}>\n            <GatherCardColumn />\n          </Card.Group>\n        </Grid.Column>\n        <Grid.Column textAlign=\"center\" width={5} style={columnStyle}>\n          <Header style={headerStyle}>\n            <Icon name=\"search\" />\n            Explore\n          </Header>\n\n          <Card.Group style={cardGroupStyle}>\n            <ExploreCardColumn />\n          </Card.Group>\n        </Grid.Column>\n        <Grid.Column textAlign=\"center\" width={5} style={columnStyle}>\n          <Header style={headerStyle}>\n            <Icon name=\"student\" />\n            Donate\n          </Header>\n        </Grid.Column>\n      </Grid>\n    </div>\n  );\n};\n\nexport default DataSquare;\n","/**\n * Intersect ordered numbers across multiple arrays.\n * Used in this app to quickly intersect the table row ids from different filters (e.g., text query, date, key)\n *\n * @param {array} arrays an array of arrays, where each array has sorted (!!!) integers\n * @returns An array of integers\n */\nconst intersect = (arrays) => {\n  arrays = arrays.filter((array) => array !== null);\n  if (arrays.length === 0) return null;\n  if (arrays.length === 1) return arrays[0];\n\n  const cursors = new Array(arrays.length).fill(0);\n  const res = [];\n\n  while (!anyDone(arrays, cursors)) {\n    if (allEqual(arrays, cursors)) {\n      console.log(cursors[0]);\n      res.push(arrays[0][cursors[0]]);\n      for (let i = 0; i < cursors.length; i++) cursors[i]++;\n    }\n    const max = allMax(arrays, cursors);\n    for (let i = 0; i < cursors.length; i++) {\n      if (arrays[i][cursors[i]] < max) cursors[i]++;\n    }\n  }\n  return res;\n};\n\nconst anyDone = (arrays, cursors) => {\n  for (let i = 0; i < arrays.length; i++) {\n    if (arrays[i].length <= cursors[i]) return true;\n  }\n  return false;\n};\n\nconst allEqual = (arrays, cursors) => {\n  for (let i = 1; i < arrays.length; i++) {\n    if (arrays[i][cursors[i]] !== arrays[0][cursors[0]]) return false;\n  }\n  console.log(\"-------------\");\n  for (let i = 0; i < arrays.length; i++) {\n    console.log(arrays[i][cursors[i]]);\n  }\n  return true;\n};\n\nconst allMax = (arrays, cursors) => {\n  let max = arrays[0][cursors[0]];\n  for (let i = 1; i < arrays.length; i++) {\n    if (arrays[i][cursors[i]] > max) max = arrays[i][cursors[i]];\n  }\n  return max;\n};\n\nexport default intersect;\n","import React from \"react\";\nimport { Grid } from \"semantic-ui-react\";\n\n/**\n * Create a Grid with a background that has a color on top of it.\n * This can be used with a transparent color to for instance darken a background\n * (for deployment, probably better to eventually just use a darkened image)\n * @returns\n */\nconst ColoredBackgroundGrid = ({ children, background, color }) => {\n  // just wrap the children in this component, pass an image path to background and a string to color\n  return (\n    <>\n      <div\n        style={{\n          zIndex: 1,\n          top: 0,\n          bottom: \"100px\",\n          right: 0,\n          left: 0,\n          background: color,\n          position: \"absolute\",\n        }}\n      />\n      <Grid\n        style={{\n          height: \"90vh\",\n          overflow: \"auto\",\n          backgroundSize: \"100% 100%\",\n          backgroundImage: `url(${background})`,\n        }}\n      >\n        <div style={{ zIndex: 2, width: \"100%\", padding: \"0px\" }}>{children}</div>\n      </Grid>\n    </>\n  );\n};\n\nexport default ColoredBackgroundGrid;\n","import db from \"apis/dexie\";\nimport PropTypes from \"prop-types\";\nimport React, { useState } from \"react\";\nimport {\n  Button, ButtonGroup, Checkbox, Modal\n} from \"semantic-ui-react\";\n\nconst propTypes = {\n  /** The name of the table in DB */\n  table: PropTypes.string,\n};\n\nconst ConfirmDeleteModal = ({ table, confirm, setConfirm }) => {\n  const [ask, setAsk] = useState(!confirm.ask);\n  const n = confirm.itemIds.length;\n\n  const handleDelete = async () => {\n    await db.deleteTableIds(table, confirm.itemIds);\n    setConfirm({ open: false, ask: !ask, itemIds: [] });\n  };\n\n  if (!confirm.open) return null;\n\n  if (!confirm.ask && n === 1) {\n    handleDelete();\n    return null;\n  }\n\n  return (\n    <Modal\n      style={{ backgroundColor: \"#00000054\" }}\n      open={confirm.open}\n      onClose={() => setConfirm({ ...confirm, open: false })}\n    >\n      <Modal.Header>Delete item{n === 1 ? \"\" : \"s\"}</Modal.Header>\n      <Modal.Content>\n        <p>Are you sure you want to delete {n === 1 ? \"this item\" : `${n} items`}?</p>\n\n        <br />\n        <Modal.Actions>\n          <ButtonGroup centered=\"true\">\n            <Button\n              fluid\n              primary\n              onClick={() => setConfirm({ open: false, ask: !ask, itemIds: [] })}\n            >\n              Cancel\n            </Button>\n            <Button fluid color=\"red\" onClick={(e, d) => handleDelete()}>\n              Yes\n            </Button>\n          </ButtonGroup>\n          {n > 1 ? null : (\n            <Checkbox\n              style={{ float: \"right\" }}\n              onChange={(e, d) => setAsk(!d.value)}\n              label=\"Do not ask again. Next time, delete immediately when clicking the trash icon\"\n            />\n          )}\n        </Modal.Actions>\n      </Modal.Content>\n    </Modal>\n  );\n};\n\nConfirmDeleteModal.propTypes = propTypes;\nexport default React.memo(ConfirmDeleteModal);\n","import db from \"apis/dexie\";\nimport PropTypes from \"prop-types\";\nimport React, { useEffect, useState } from \"react\";\nimport {\n  Button, Container, Dimmer, Header, Loader, Segment, Table, Visibility\n} from \"semantic-ui-react\";\nimport ConfirmDeleteModal from \"./ConfirmDeleteModal\";\n\nconst PAGESIZE = 25;\n\nconst propTypes = {\n  /** The name of the table in DB */\n  table: PropTypes.string,\n  /** An object with layout information.\n   * The keys should be columns in the table\n   * The values are objects with a \"type\" (header, meta or description) and a react inline style\n   * See BrowsingHistory.js or SearchHistory.js for examples\n   */\n  layout: PropTypes.array,\n  /** An array with row IDs to filter on */\n  selection: PropTypes.array,\n  /** A string to indicate the loading status */\n  loading: PropTypes.oneOfType([PropTypes.string, PropTypes.bool])\n};\n\n/**\n * Creates a list of items for a given table in the indexedDB\n */\nconst DataList = ({ table, layout, selection, loading }) => {\n  const [data, setData] = useState([]);\n  const [n, setN] = useState(1);\n  const [selectionN, setSelectionN] = useState(0);\n\n  const [confirm, setConfirm] = useState({ open: false, ask: true, itemIds: [] });\n  useEffect(() => {\n    if (!table) {\n      setData([]);\n      return null;\n    }\n    fetchFromDb(table, PAGESIZE, setN, setSelectionN, setData, selection);\n  }, [table, selection, confirm]);\n\n  const onBottomVisible = async () => {\n    // infinite scroll\n    // <Visibility> checks whether bottom of (invisible) div is visible, and if so adds more data\n    const offset = data.length;\n    let newdata = null;\n    if (selection === null) {\n      newdata = await db.getTableBatch(table, offset, PAGESIZE);\n    } else {\n      newdata = await db.getTableFromIds(table, selection.slice(offset, offset + PAGESIZE));\n    }\n    setData([...data, ...newdata]);\n  };\n\n  const createItem = (item) => {\n    return layout.map((field, i) => {\n      let content = item[field];\n      if (content instanceof Date) content = content.toISOString().slice(0, 19).replace(/T/g, \" \");\n      return (<Table.Cell key={i+1}>{content}</Table.Cell>)\n    });\n  };\n\n  const createItems = () => {\n    if (data === null || data.length === 0) return null;\n\n    //const image = Object.keys(layout).find((field) => layout[field].type === \"image\");\n\n    return data.map((item, i) => {\n      return (\n        <Table.Row key={i}>\n          {/* {image ? <Item.Image size=\"tiny\" src={item[image]} /> : null} */}\n          <Table.Cell key=\"0\">\n            <Button\n              onClick={() => setConfirm({ ...confirm, open: true, itemIds: [item.id] })}\n              icon=\"trash alternate\" />\n          </Table.Cell>\n          {createItem(item)}\n        </Table.Row>\n      );\n    });\n  };\n\n  return (\n    <Container\n      style={{\n        height: \"100%\",\n        width: \"100%\",\n        padding: \"0\",\n        background: \"#00000087\",\n      }}\n    >\n      <Segment style={{ background: \"white\" }}>\n        <Header textAlign=\"center\" style={{ color: \"black\" }}>\n          <Dimmer active={loading}>\n            <Loader />\n          </Dimmer>\n          {selectionN === n ? null : (\n            <Button\n              onClick={() => setConfirm({ ...confirm, open: true, itemIds: selection })}\n              icon=\"trash alternate\"\n              style={{ color: \"#b23434bd\", height: \"1em\", padding: \"0\", background: \"#ffffff00\" }}\n            />\n          )}\n          {selectionN === n ? n : `${selectionN} / ${n}`} items\n        </Header>\n      </Segment>\n\n      <Container style={{ width: \"100%\", height: \"100%\", overflowY: \"auto\" }}>\n        <Visibility continuous onBottomVisible={onBottomVisible}>\n          <Table striped fixed>\n            <Table.Header>\n              <Table.Row>\n                { ['', ...layout].map((field, i) =>\n                  (<Table.HeaderCell key={i} width={[1, 3, 10, 10][i]} style={{top: \"0px\", position: \"sticky\", zIndex: \"2\"}}>\n                    {field.charAt(0).toUpperCase() + field.slice(1)}\n                  </Table.HeaderCell>))\n                }\n              </Table.Row>\n            </Table.Header>\n            <Table.Body>{createItems()}</Table.Body>\n          </Table>\n        </Visibility>\n      </Container>\n\n      <ConfirmDeleteModal table={table} confirm={confirm} setConfirm={setConfirm} />\n    </Container>\n  );\n};\n\n\nconst fetchFromDb = async (table, pageSize, setN, setSelectionN, setData, selection) => {\n  let n = await db.getTableN(table);\n  setSelectionN(selection === null ? n : selection.length);\n  setN(n);\n  let newdata = [];\n\n  if (n > 0) {\n    if (selection === null) {\n      newdata = await db.getTableBatch(table, 0, pageSize);\n    } else {\n      newdata = await db.getTableFromIds(table, selection.slice(0, PAGESIZE));\n    }\n  }\n\n  // prevents delay after removing items while other filters are still resetting\n  if (newdata !== null && newdata.length === 0) setSelectionN(0);\n\n  setData(newdata);\n};\n\nDataList.propTypes = propTypes;\nexport default React.memo(DataList);\n","import React, { useEffect, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { useLiveQuery } from \"dexie-react-hooks\";\nimport { Button, Input } from \"semantic-ui-react\";\nimport db from \"apis/dexie\";\n\nconst propTypes = {\n  /** The name of the table */\n  table: PropTypes.string,\n  /** An array with names of the (text) columns in the table that should be used for the fulltext search */\n  searchOn: PropTypes.array,\n  /** A callback function for returning the row IDs that match the query */\n  setSelection: PropTypes.func,\n  /** A callback function for setting the loading status */\n  setLoading: PropTypes.func,\n};\n\n/**\n * Create an input for full text search\n */\nconst QueryInput = ({ table, searchOn, setSelection, setLoading }) => {\n  const [search, setSearch] = useState(\"\");\n  const [selectionStatus, setSelectionStatus] = useState(\"none\");\n\n  const n = useLiveQuery(() => db.idb.table(table).count());\n\n  useEffect(() => {\n    setLoading(selectionStatus === \"searching\");\n  }, [selectionStatus, setLoading]);\n\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      searchSelection(table, searchOn, search, setSelection, setSelectionStatus);\n    }, 500);\n    return () => clearTimeout(timer);\n  }, [table, search, setSelectionStatus, searchOn, setSelection, n]);\n\n  return (\n    <Input\n      label=\"Search data\"\n      loading={selectionStatus === \"searching\"}\n      value={search}\n      icon={\n        <Button\n          icon=\"close\"\n          onClick={() => setSearch(\"\")}\n        />\n      }\n      onChange={(e, d) => setSearch(d.value)}\n    ></Input>\n  );\n};\n\nconst searchSelection = async (table, searchOn, search, setSelection, setSelectionStatus) => {\n  if (search === \"\") {\n    setSelection(null);\n    setSelectionStatus(\"none\");\n    return;\n  }\n  setSelectionStatus(\"searching\");\n\n  const selection = await db.getSelectionQuery(table, searchOn, search);\n  setSelection(selection);\n  setSelectionStatus(\"finished\");\n};\n\nQueryInput.propTypes = propTypes;\nexport default React.memo(QueryInput);\n\n// just keeping this here so I wont forget how insanely usefull this is.\n// A second argument to React.memo lets you view the prev and next props\n// to see which bastard rerenders the living hell out of a component\n// export default React.memo(QueryTable, (prevprops, nextprops) => {\n//   console.log(prevprops);\n//   console.log(nextprops);\n//   console.log(prevprops.selection === nextprops.selection);\n//   console.log(prevprops.setSelection === nextprops.setSelection);\n//   console.log(prevprops.searchOn === nextprops.searchOn);\n// });\n","import db from \"apis/dexie\";\nimport PropTypes from \"prop-types\";\nimport React, { useEffect, useState } from \"react\";\nimport { Container, Dimmer, Header, Item, Loader } from \"semantic-ui-react\";\nimport \"./Statistics.css\";\n\nconst propTypes = {\n  /** An array with row IDs to filter on */\n  selection: PropTypes.array,\n  /** A string to indicate the loading status */\n  loading: PropTypes.oneOfType([PropTypes.string, PropTypes.bool])\n};\n\n/**\n * Creates a list of statistics based on the selected table\n */\nconst Statistics = ({selection, loading }) => {\n  const [data, setData] = useState([]);\n  const [loadingData, setLoadingData] = useState(false);\n\n  useEffect(() => {\n    fetchFromDb(setData, setLoadingData, selection);\n  }, [selection, setData]);\n\n\n  return (\n    <Container\n      style={{\n        height: \"98%\",\n        padding: \"20px\",\n        background: \"#55555587\",\n        borderRadius: \"10px\"\n      }}\n    >\n      <Dimmer active={loading || loadingData}>\n        <Loader />\n      </Dimmer>\n      <Header as=\"h1\" align={\"center\"} style={{ color: \"white\", padding: \"0\", margin: \"0\" }}>\n        Statistics\n      </Header>\n      <Item.Group>\n        <Item>\n          <Item.Content>\n            <Item.Header style={{ color: \"white\"}}>Website Visits</Item.Header>\n            <Item.Description style={{ color: \"white\"}}>{data.total_visits}</Item.Description>\n          </Item.Content>\n        </Item>\n        <Item>\n          <Item.Content>\n            <Item.Header style={{ color: \"white\"}}>Most Visited Domain</Item.Header>\n            <Item.Description style={{ color: \"white\"}}>{data.max_domain} ({data.max})</Item.Description>\n          </Item.Content>\n        </Item>\n        <Item>\n          <Item.Content>\n            <Item.Header style={{ color: \"white\"}}>Average visits per Domain</Item.Header>\n            <Item.Description style={{ color: \"white\"}}>{data.mean}</Item.Description>\n          </Item.Content>\n        </Item>\n        <Item>\n          <Item.Content>\n            <Item.Header style={{ color: \"white\"}}>Number of Unique Domains</Item.Header>\n            <Item.Description style={{ color: \"white\"}}>{data.num_domains}</Item.Description>\n          </Item.Content>\n        </Item>\n        <Item>\n          <Item.Content>\n            <Item.Header style={{ color: \"white\"}}>Google Searches</Item.Header>\n            <Item.Description style={{ color: \"white\"}}>{data.search}</Item.Description>\n          </Item.Content>\n        </Item>\n        <Item>\n          <Item.Content>\n            <Item.Header style={{ color: \"white\"}}>Youtube Videos</Item.Header>\n            <Item.Description style={{ color: \"white\"}}>{data.youtube}</Item.Description>\n          </Item.Content>\n        </Item>\n      </Item.Group>\n    </Container>\n  );\n};\n\nconst fetchFromDb = async (setData, setLoadingData, selection) => {\n  setLoadingData(true);\n  db.getDataFrame(selection).then(async (stats) => {\n\n    const data = stats.sortBy(\"domain\");\n    let group = data.groupBy(\"domain\");\n\n    let counts = group.aggregate(group => group.count()).rename(\"aggregation\", \"domain_count\");\n    counts = counts.sortBy('domain_count', true);\n\n    const statistics = {};\n    const total_visits = data.count();\n    statistics['total_visits'] = total_visits;\n    statistics['max'] = total_visits && counts.stat.max('domain_count');\n    statistics['max_domain'] = total_visits && counts.getRow(0).get(\"domain\");\n    statistics['mean'] = total_visits && Math.round(counts.stat.mean(\"domain_count\"));\n    statistics['num_domains'] = counts.count();\n    statistics['youtube'] = await db.getTableN(\"youtube\");\n    statistics['search'] = await db.getTableN(\"searchhistory\");\n\n    setData(statistics);\n    setLoadingData(false);\n  })\n};\n\nStatistics.propTypes = propTypes;\nexport default React.memo(Statistics);","import { createClassFromSpec } from 'react-vega';\n\nexport default createClassFromSpec({spec: {\n  \"$schema\": \"https://vega.github.io/schema/vega/v5.json\",\n  \"width\": 700,\n  \"height\": 480,\n  \"padding\": 0,\n  \"autosize\": \"none\",\n\n  \"data\": [\n    {\n      \"name\": \"tree\",\n      \"transform\": [\n        {\n          \"type\": \"stratify\",\n          \"key\": \"name\",\n          \"parentKey\": \"parent\"\n        },\n        {\n          \"type\": \"pack\",\n          \"field\": \"count\",\n          \"sort\": {\"field\": \"count\"},\n          \"size\": [{\"signal\": \"width\"}, {\"signal\": \"height\"}]\n        },\n        {\n          \"type\": \"filter\",\n          \"expr\": \"datum.name != 'root' && datum.type != 'category'\"\n        }\n      ]\n    }\n  ],\n\n  \"signals\": [\n    {\n      \"name\": \"selectedDatum\",\n      \"value\": {},\n      \"on\": [\n        { \"events\": \"click\", \"update\": \"datum\", \"force\": \"true\" }\n      ]\n    },\n    {\n      \"name\": \"filterDatum\",\n      \"value\": {},\n      \"on\": [\n        { \"events\": \"*:dblclick\", \"update\": \"datum\", \"force\": \"true\" }\n      ]\n    }\n  ],\n\n  \"scales\": [\n    {\n      \"name\": \"color\",\n      \"type\": \"ordinal\",\n      \"domain\": {\"data\": \"tree\", \"field\": \"category\"},\n      \"range\": {\"scheme\": \"category20\"}\n    }\n  ],\n\n  \"marks\": [\n    {\n      \"type\": \"symbol\",\n      \"from\": {\"data\": \"tree\"},\n      \"encode\": {\n        \"enter\": {\n          \"shape\": {\"value\": \"circle\"},\n          \"fill\": {\"scale\": \"color\", \"field\": \"category\"},\n          \"tooltip\": {\"signal\": \"datum.name\"}\n        },\n        \"update\": {\n          \"x\": {\"field\": \"x\"},\n          \"y\": {\"field\": \"y\"},\n          \"size\": {\"signal\": \"4 * datum.r * datum.r\"},\n          \"stroke\": {\"value\": \"white\"},\n          \"strokeWidth\": {\"value\": 0.8}\n        },\n        \"hover\": {\n          \"stroke\": {\"value\": \"red\"},\n          \"strokeWidth\": {\"value\": 2}\n        }\n      }\n    },\n    {\n      \"type\": \"image\",\n      \"from\": {\"data\": \"tree\"},\n      \"encode\": {\n        \"enter\": {\n          \"url\": {\"signal\": \"datum.r < 16 ? '' : datum.logo\"},\n          \"tooltip\": {\"signal\": \"datum.name\"}\n        },\n        \"update\": {\n          \"x\": {\"signal\": \"datum.x - min(datum.r, 32) / 2\"},\n          \"y\": {\"signal\": \"datum.y - min(datum.r, 32) / 2\"},\n          \"width\": {\"signal\": \"min(datum.r, 32)\"},\n          \"height\": {\"signal\": \"min(datum.r, 32)\"},\n        },\n        \"hover\": {\n          \"stroke\": {\"value\": \"red\"},\n          \"strokeWidth\": {\"value\": 2}\n        }\n      }\n    }\n  ]\n}});\n","import React, { useRef, useState, useEffect } from 'react';\n\n\nconst generateToken = async (key, urls) => {\n  var message = ([key].concat(urls)).join(\"|\");\n  const msgBuffer = new TextEncoder().encode(message);\n  const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);\n  const hashArray = Array.from(new Uint8Array(hashBuffer));\n  return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');\n};\n\n\nexport const useDomainInfo = (domains) => {\n  const cacheRef = useRef({});\n  const [status, setStatus] = useState('idle');\n  const [data, setData] = useState([]);\n\n  useEffect(() => {\n\n    const fetchData = async () => {\n      setStatus('fetching');\n      let cache = cacheRef.current;\n\n      // Check which domains are in the cache\n      const cachedDomains = Object.keys(cache);\n      const domainsToFetch = domains.filter(domain => !cachedDomains.includes(domain));\n      if (domainsToFetch.length === 0) {\n        setData(cache);\n        setStatus('fetched from cache');\n        return;\n      }\n\n      // Create empty entries in cache to prevent refetching if domain is not available in service\n      for (let domain of domainsToFetch) {\n        cache[domain] = {};\n      }\n\n      // Construct request\n      const token = await generateToken('1234', domainsToFetch);\n      const body = {\n        token,\n        urls: domainsToFetch\n      };\n\n      // Make request\n      const response = await fetch('https://dd.amcat.nl', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(body),\n      });\n\n      // Merge result with cache\n      const data = await response.json();\n      for (const [key, value] of Object.entries(data)) {\n        cache[key] = value;\n      }\n      setData(cache);\n      setStatus('fetched');\n    }\n\n    fetchData();\n\n  }, [domains]);\n\n  return [ status, data ];\n};\n","import { useState, useEffect } from 'react';\nimport db from \"apis/dexie\";\nimport { useLiveQuery } from \"dexie-react-hooks\";\nimport { useDomainInfo } from './DomainInfo';\n\nconst useRawEntries = (table) => {\n  const [entries, setEntries] = useState([]);\n  const n = useLiveQuery(() => db.idb.table(table).count());\n\n  useEffect(() => {\n    const fetchData = async () => {\n      console.log(\"fetching from db\", n);\n      const t = await db.idb.table(table);\n      const collection = await t.toCollection();\n      const rawEntries = await collection.toArray();\n      setEntries(rawEntries);\n    };\n    fetchData();\n  }, [table, n]);\n\n  return [entries];\n}\n\nexport const useDatabaseEntries = (table, field) => { //TODO: I guess this only applies for field === 'domain'\n  const [loadingData, setLoadingData] = useState(false);\n  const [keyTotalObj, setKeyTotalObj] = useState({});\n  const [entries] = useRawEntries(table);\n  const [allDomains, setAllDomains] = useState([]);\n  const [domainInfoStatus, domainInfo] = useDomainInfo(allDomains);\n\n  // List of domains from raw entries\n  useEffect(() => {\n    console.log(entries);\n    const domains = [...new Set(\n      entries.map(e => e['domain'])\n      .filter(e => e !== 'localhost' && e !== 'newtab'))\n    ];\n    setAllDomains(domains);\n  }, [entries]);\n\n  // Process raw entries and domain info into object tree for Vega\n  useEffect(() => {\n    console.log(\"fetching\");\n    setLoadingData(true);\n\n    const keyTotalObj = {};\n\n    for (let entry of entries) {\n      let keys = Array.isArray(entry[field]) ? entry[field] : [entry[field]];\n      for (let key of keys) {\n        if (key !== \"\") {\n          key = key.split('.').slice(-2).join('.') // poor man's domain extraction\n\n          // Domain entry\n          if (keyTotalObj[key] === undefined) {\n            const category = domainInfo[key]?.category ? domainInfo[key].category : \"Unknown\";\n            const logo = domainInfo[key]?.logo ? `https://ifb.sharkwing.com/logo/${ domainInfo[key].logo.split('/').slice(-1) }` : `https://ifb.sharkwing.com/favicon/${key}.ico`;\n            keyTotalObj[key] = {\n              id: entry.id,\n              type: 'domain',\n              name: key,\n              parent: category,\n              count: 1,\n              ids: [entry.id],\n              category,\n              logo\n            };\n          }\n          else {\n            keyTotalObj[key].count++;\n            keyTotalObj[key].ids.push(entry.id);\n          }\n  \n          // Url entry\n          const url = entry['url'];\n          if (url !== key) {\n            if (keyTotalObj[url] === undefined) {\n              keyTotalObj[url] = {\n                id: entry.id,\n                type: 'url',\n                name: url,\n                title: entry.title,\n                parent: key,\n                count: 1,\n                ids: [entry.id]\n              }\n            }\n            else {\n              keyTotalObj[url].count++;\n              keyTotalObj[url].ids.push(entry.id);\n            }\n          }\n        }\n      }\n    }\n\n    setKeyTotalObj(keyTotalObj);\n    setLoadingData(false);\n  }, [domainInfo, entries, field]);\n\n  return [ loadingData, keyTotalObj ];\n};\n","import React, { useEffect, useState } from \"react\";\nimport { PropTypes } from \"prop-types\";\nimport BubbleChartSpec from './BubbleChartSpec';\nimport ConfirmDeleteModal from \"./ConfirmDeleteModal\";\nimport { useDatabaseEntries } from \"./DatabaseEntries\";\nimport { Card, Button, Image, Dimmer, Loader } from \"semantic-ui-react\";\n\nconst propTypes = {\n  /** The name of the table in db */\n  table: PropTypes.string,\n  /** The name of the field in db */\n  field: PropTypes.string,\n  /** An array with a selection of row ids in table */\n  inSelection: PropTypes.array,\n  /** An integer specifying the number of words in the cloud*/\n  nWords: PropTypes.number,\n  /** A boolean for whether data is loading */\n  loading: PropTypes.bool,\n  /** A callback for setting the selection state */\n  setOutSelection: PropTypes.func,\n};\n\n/**\n * Makes a wordcloud for keys, for a given table:field in db\n */\nconst BubbleChart = ({ table, field, inSelection, nWords, loading, setOutSelection }) => {\n  const [data, setData] = useState({tree: []}); // input for vega visualization\n//  const [loadingData, setLoadingData] = useState(false);\n  const [selectedDatum, setSelectedDatum] = useState(null);\n  const [confirm, setConfirm] = useState({ open: false, ask: true, itemIds: [] });\n  const [filteredDatum, setFilteredDatum] = useState(null);\n  const [loadingData, keyTotalObj] = useDatabaseEntries(table, field);\n\n  // Update selection\n  useEffect(() => {\n    console.log(\"setting out selection\")\n    setOutSelection(filteredDatum === null ? null : filteredDatum.ids);\n  }, [filteredDatum, setOutSelection]);\n\n  // Filter keyTotalObj for current selection and zoom level\n  useEffect(() => {\n    console.log(\"filtering\")\n\n    // Filter\n    let nodes = Object.values(keyTotalObj);\n    console.log(nodes.length);\n    if (inSelection !== null) {\n      nodes = nodes.filter(obj => inSelection.includes(obj.id));\n    }\n    console.log(nodes.length);\n    if (filteredDatum === null) {\n      nodes = nodes.filter(obj => obj.type !== 'url');\n    }\n    console.log(nodes.length);\n\n    // Only include used categories\n    const categories = [...new Set(Object.values(nodes).map(node => node.category))];\n    const cats = [];\n    for (let category of categories) {\n      cats.push({\n        type: 'category',\n        name: category,\n        count: 1,\n        parent: \"root\"\n      });\n    }\n\n    let keyTotal = [\n      {type: 'root', name: 'root'},\n      ...cats,\n      ...nodes\n    ];\n    console.log(keyTotal);\n    setData({ tree: keyTotal });\n  }, [keyTotalObj, inSelection]); //no, we don't want filteredDatum as dependency\n\n  // Vega signal handler\n  const onSelectedDatum = (signal, datum) => {\n    console.log(\"selected \", datum);\n    if (datum === null) {\n      // Clicking outside circles will reset filter\n      setFilteredDatum(null);\n      setSelectedDatum(null);\n    }\n    else {\n      if (datum.type === 'domain' || datum.type === 'url') {\n        setSelectedDatum(datum);\n      }\n    }\n  }\n\n  // Vega signal handler\n  const onFilterDatum = (signal, datum) => {\n    console.log(\"filter \", datum);\n    setFilteredDatum(datum);\n    setSelectedDatum(null);\n  }\n\n  // Popup button handler\n  const filterSelectedDatum = () => {\n    setFilteredDatum(selectedDatum);\n    setSelectedDatum(null);\n  };\n\n  // Popup button handler\n  const deleteSelectedDatum = () => {\n    setConfirm({ ...confirm, open: true, itemIds: selectedDatum.ids });\n    setSelectedDatum(null);\n  };\n\n  const signalListeners = {\n    selectedDatum: onSelectedDatum,\n    filterDatum: onFilterDatum\n  };\n\n  const popupStyle = {\n    zIndex: 1,\n    position: \"absolute\",\n    left: selectedDatum ? selectedDatum.x : 0,\n    top: selectedDatum ? selectedDatum.y : 0\n  };\n\n  return (\n    <div style={{position: \"relative\"}}>\n      <Dimmer active={loading || loadingData}>\n        <Loader />\n      </Dimmer>\n      <BubbleChartSpec data={data} signalListeners={signalListeners} actions={false} />\n      { selectedDatum && <div style={popupStyle}>\n        <Card>\n          <Card.Content>\n            { selectedDatum.logo && <Image\n              floated='left'\n              size='mini'\n              src={selectedDatum.logo}\n            /> }\n            <Button\n              basic\n              floated='right'\n              size='mini'\n              icon='close'\n              onClick={() => setSelectedDatum(null)}\n            />\n            <Card.Header>{selectedDatum.name}</Card.Header>\n            <Card.Meta>{`${selectedDatum.count} visits`}</Card.Meta>\n            <Card.Description>\n              <p>{ selectedDatum.title && selectedDatum.title }</p>\n              <p>Category: {selectedDatum.category ? selectedDatum.category : 'unknown'}</p>\n            </Card.Description>\n          </Card.Content>\n          <Card.Content extra>\n            <div className='ui two buttons'>\n              <Button basic color='blue' onClick={filterSelectedDatum}>\n                Select\n              </Button>\n              <Button basic color='red' onClick={deleteSelectedDatum}>\n                Delete\n              </Button>\n            </div>\n          </Card.Content>\n        </Card>\n      </div>}\n      <ConfirmDeleteModal table={table} confirm={confirm} setConfirm={setConfirm} />\n    </div>\n  );\n}\n\nBubbleChart.propTypes = propTypes;\nexport default React.memo(BubbleChart);\n","import db from \"apis/dexie\";\nimport { useLiveQuery } from \"dexie-react-hooks\";\nimport { PropTypes } from \"prop-types\";\nimport React, { useEffect, useState } from \"react\";\nimport ReactWordcloud from \"react-wordcloud\";\nimport { Dimmer, Dropdown, Grid, Header, Loader } from \"semantic-ui-react\";\n\nconst wordcloudOptions = {\n  rotations: 0,\n  enableOptimizations: true,\n  enableTooltip: false,\n  deterministic: true,\n  fontFamily: \"impact\",\n  fontSizes: [20, 60],\n  transitionDuration: 500,\n  colors: [\"white\"],\n};\nconst wordcloudSize = undefined;\n\nconst propTypes = {\n  /** The name of the table in db */\n  table: PropTypes.string,\n  /** The name of the field in db */\n  field: PropTypes.string,\n  /** An array with a selection of row ids in table */\n  inSelection: PropTypes.array,\n  /** An integer specifying the number of words in the cloud*/\n  nWords: PropTypes.number,\n  /** A boolean for whether data is loading */\n  loading: PropTypes.bool,\n  /** A callback for setting the selection state */\n  setOutSelection: PropTypes.func,\n};\n\n/**\n * Makes a wordcloud for keys, for a given table:field in db\n */\nconst KeyCloud = ({ table, field, inSelection, nWords, loading, setOutSelection }) => {\n  const [keys, setKeys] = useState(new Set([]));\n  const [words, setWords] = useState([]);\n  const [data, setData] = useState(null);\n  const [loadingData, setLoadingData] = useState(false);\n\n  const n = useLiveQuery(() => db.idb.table(table).count());\n\n  useEffect(() => {\n    prepareData(table, field, inSelection, setData, setLoadingData, setKeys);\n  }, [table, field, inSelection, setData, n, setLoadingData, setKeys]);\n\n  useEffect(() => {\n    if (!data) {\n      setWords([]);\n      return null;\n    }\n    const words = data.keys.slice(0, nWords).map((word) => {\n      const text = word.text.replace(\"www.\", \"\");\n      return { text: text, domain: word.text, value: word.value };\n    });\n    setWords(words);\n  }, [data, nWords]);\n\n  useEffect(() => {\n    let ignore = false;\n    const getSelection = async () => {\n      let selection = keys.size > 0 ? await db.getSelectionAny(table, field, [...keys]) : null;\n      if (!ignore) setOutSelection(selection);\n    };\n    getSelection();\n    return () => {\n      ignore = true; // use closure to 'cancel' promise. prevents delayed older requests from overwriting new\n    };\n  }, [keys, setOutSelection, table, field]);\n\n  const callbacks = React.useCallback(() => {\n    return {\n      onWordClick: (word) => {\n        setKeys((old) => {\n          const newkeys = new Set([...old]);\n          if (newkeys.has(word.domain)) {\n            newkeys.delete(word.domain);\n          } else {\n            newkeys.add(word.domain);\n          }\n          return newkeys;\n        });\n      },\n      getWordColor: (word) => {\n        if (keys.size === 0) return \"white\";\n        return keys.has(word.domain) ? \"white\" : \"grey\";\n      },\n    };\n  }, [keys]);\n\n  return (\n    <Grid\n      style={{\n        height: \"100%\",\n        width: \"100%\",\n        background: \"#ffffff00\",\n        border: \"none\",\n        boxShadow: \"none\",\n        paddingTop: \"2em\",\n      }}\n    >\n      <Grid.Column width={12} style={{ padding: \"0\", margin: \"0\" }}>\n        <Dimmer active={loading || loadingData}>\n          <Loader />\n        </Dimmer>\n        <Header as=\"h1\" align={\"center\"} style={{ color: \"white\", padding: \"0\", margin: \"0\" }}>\n          Top {nWords} {field}s\n        </Header>\n        <div style={{ overflow: \"auto\" }}>\n          <div style={{ height: \"400px\", minWidth: \"800px\" }}>\n            <ReactWordcloud\n              words={words}\n              minSize={wordcloudSize}\n              callbacks={callbacks()}\n              options={wordcloudOptions}\n            />\n          </div>\n        </div>\n      </Grid.Column>\n      <Grid.Column width={4}>\n        <Header style={{ color: \"white\" }}>{field.toUpperCase()} FILTER</Header>\n        <p style={{ fontStyle: \"italic\", color: \"white\" }}>\n          Filter on {field} by adding them below or clicking on the wordcloud\n        </p>\n        <Dropdown\n          fluid\n          multiple\n          selection\n          clearable\n          search\n          style={{\n            width: \"100%\",\n            color: \"white\",\n            minHeight: \"22em\",\n            background: \"#ffffff21\",\n          }}\n          value={[...keys]}\n          onChange={(e, d) => setKeys(new Set(d.value))}\n          options={\n            data\n              ? data.uniqueKeys.map((e) => ({\n                  value: e,\n                  text: e.replace(\"www.\", \"\"),\n                  key: e,\n                }))\n              : []\n          }\n        />\n      </Grid.Column>\n    </Grid>\n  );\n};\n\nconst prepareData = async (table, field, selection, setData, setLoadingData, setKeys) => {\n  setLoadingData(true);\n\n  let keyTotalObj = {};\n\n  let t = await db.idb.table(table);\n\n  let uniqueKeys = await t.orderBy(field).uniqueKeys();\n\n  let collection =\n    selection === null ? await t.toCollection() : await t.where(\"id\").anyOf(selection);\n\n  await collection.each((url) => {\n    let keys = Array.isArray(url[field]) ? url[field] : [url[field]];\n    for (let key of keys) {\n      if (key !== \"\") {\n        keyTotalObj[key] = (keyTotalObj[key] || 0) + 1;\n      }\n    }\n  });\n  let keyTotal = Object.keys(keyTotalObj).map((key) => {\n    return { text: key, value: keyTotalObj[key] };\n  });\n  keyTotal.sort((a, b) => b.value - a.value); // sort from high to low value\n  setData({ keys: keyTotal, uniqueKeys: uniqueKeys });\n  setLoadingData(false);\n\n  setKeys((keys) => new Set([...keys].filter((key) => keyTotalObj[key] != null)));\n};\n\nKeyCloud.propTypes = propTypes;\nexport default React.memo(KeyCloud);\n","import db from \"apis/dexie\";\nimport PropTypes from \"prop-types\";\nimport React, { useState, useEffect } from \"react\";\nimport {\n  Button, ButtonGroup, Modal\n} from \"semantic-ui-react\";\nimport { useLiveQuery } from \"dexie-react-hooks\";\n\nconst propTypes = {\n  /** The name of the table in DB */\n  table: PropTypes.string,\n};\n\nconst tables = [\"browsinghistory\", \"searchhistory\", \"youtube\"];\n\nconst ConfirmDonateModal = ({ confirm, setConfirm }) => {\n  const [counts, setCounts] = useState({});\n  const n = useLiveQuery(() => db.idb.table(\"browsinghistory\").count()); //TODO: include other tables\n\n  // Count the data being donated\n  useEffect(() => {\n    const getCounts = async () => {\n      const counts = {};\n      for (let t of tables) {\n        counts[t] = await db.idb.table(t).count();\n      }\n      setCounts(counts);\n    }\n    getCounts();\n  }, [setCounts, n]);\n\n  // After donate confirmation\n  const handleDonate = async () => {\n\n    // Collect all data\n    const data = {};\n    const tableToJson = async (table) => {\n      const t = await db.idb.table(table);\n      const collection = await t.toCollection();\n      data[table] = await collection.toArray();\n    }\n    await Promise.all(tables.map(async table => await tableToJson(table)));\n\n    console.log(data);\n    //TODO: send to endpoint\n\n    // Close dialog\n    setConfirm({ open: false, donated: true });\n  };\n\n  if (!confirm.open) return null;\n\n  return (\n    <Modal\n      style={{ backgroundColor: \"#00000054\" }}\n      open={confirm.open}\n      onClose={() => setConfirm({ ...confirm, open: false, donated: false })}\n    >\n      <Modal.Header>Donate data</Modal.Header>\n      <Modal.Content>\n        <p>Thank you for considering to donate your data to this project.</p>\n        <p>Please understand the following:</p>\n        <ul>\n          <li>Your data will be kept until 5 years after publishing the results of this project.</li>\n          <li>Your data will never be shared with third parties.</li>\n        </ul>\n        <p>You wil be donating the following items: { Object.keys(counts).map(key => `${key}: ${counts[key]}`).join(', ') }</p>\n        <p>If you click on \"Confirm\", your data will be uploaded. If you want to check your data again and\n          filter out items you do not want to share, please click on \"Go Back\". You will get back to the\n          overview page.</p>\n        <p>After uploading your data, you will receive some more interesting facts about your online self!</p>\n        <br />\n        <Modal.Actions>\n          <ButtonGroup centered=\"true\">\n            <Button\n              fluid\n              primary\n              onClick={() => setConfirm({ open: false, itemIds: [] })}\n            >\n              Go Back\n            </Button>\n            <Button fluid color=\"green\" onClick={(e, d) => handleDonate()}>\n              Confirm\n            </Button>\n          </ButtonGroup>\n        </Modal.Actions>\n      </Modal.Content>\n    </Modal>\n  );\n};\n\nConfirmDonateModal.propTypes = propTypes;\nexport default React.memo(ConfirmDonateModal);\n","import PropTypes from \"prop-types\";\nimport React, { Fragment, useEffect, useState } from \"react\";\nimport { useHistory } from \"react-router\";\nimport { Button, Grid, Icon, Segment } from \"semantic-ui-react\";\nimport intersect from \"util/intersect\";\nimport ColoredBackgroundGrid from \"./dashboardParts/ColoredBackgroundGrid\";\nimport DataList from \"./dashboardParts/DataList\";\nimport QueryInput from \"./dashboardParts/QueryInput\";\nimport Statistics from \"./dashboardParts/Statistics\";\nimport BubbleChart from \"./dashboardParts/BubbleChart\";\nimport KeyCloud from \"./dashboardParts/KeyCloud\";\nimport ConfirmDonateModal from \"./dashboardParts/ConfirmDonateModal\";\n\nconst gridStyle = { paddingTop: \"0em\", marginTop: \"0em\", height: \"90vh\" };\n\nconst propTypes = {\n  /** an Array indicating which fields in table should be used in the fulltext search */\n  searchOn: PropTypes.array.isRequired,\n  /** an object that conveys which fields in the table are shown in the DataList */\n  layout: PropTypes.array.isRequired,\n  /** the name of the table in the indexedDB */\n  table: PropTypes.string.isRequired,\n  /** the field in the table that is used in the wordcloud. Can also be a multientry index (e.g., an indexed array of words in indexedDB) */\n  cloudKey: PropTypes.string.isRequired,\n};\n\n/**\n * Renders a dashboard page with components for browsing and visualizing history data\n */\nconst HistoryDashboard = ({ searchOn, layout, table, cloudKey }) => {\n  const history = useHistory();\n\n  const [loading, setLoading] = useState(false);\n\n  // The selection states are arrays of row ids\n  // the intersection of these arrays is used to combine selections\n  // this is ok-ish fast, since the id indices are ordered; see intersect function\n  // but i'm sure there are better solutions\n  const [selection, setSelection] = useState(null);\n  const [querySelection, setQuerySelection] = useState(null);\n  const [domainSelection, setDomainSelection] = useState(null);\n  const [keyInSelection, setKeyInSelection] = useState(null);\n  const [keyOutSelection, setKeyOutSelection] = useState(null);\n  \n  const [confirmDonate, setConfirmDonate] = useState({ open: false, itemIds: [] });\n\n  useEffect(() => {\n    console.log(\"intersect\")\n    setSelection(intersect([querySelection, domainSelection]));\n  }, [querySelection, domainSelection]);\n\n  // Navigate to goodies page after donation\n  useEffect(() => {\n    if (confirmDonate.donated) {\n      history.push(`${process.env.PUBLIC_URL}/goodies`);\n    }\n  }, [confirmDonate]);\n\n  const donateData = () => {\n    // Show confirmation dialog, which also handles donation\n    setConfirmDonate({ ...confirmDonate, open: true });\n  }\n\n  return (\n    <Fragment>\n    <ColoredBackgroundGrid color={\"#000000b0\"}>\n      <Segment>\n        <Button\n          style={{ background: \"#ffffff\", margin: \"0\", float: \"left\" }}\n          onClick={() => history.push(`${process.env.PUBLIC_URL}/datasquare`)}>\n          <Icon name=\"backward\" />\n          Go back\n        </Button>\n        <div style={{display: \"table\", margin: \"0 auto\"}}>\n          <QueryInput\n              table={table}\n              searchOn={searchOn}\n              setSelection={setQuerySelection}\n              setLoading={setLoading} />\n        </div>\n      </Segment>\n      <Grid divided={\"vertically\"} style={gridStyle}>\n          <Grid.Row centered columns={2}>\n            <Grid.Column width={10} style={{ paddingLeft: \"2em\", paddingRight: \"0\"}}>\n              { table === \"browsinghistory\" &&\n                <BubbleChart\n                  table={table}\n                  field={cloudKey}\n                  inSelection={selection}\n                  nWords={50}\n                  loading={loading}\n                  setOutSelection={setDomainSelection}\n                />\n              }\n              { table !== \"browsinghistory\" &&\n                  <KeyCloud\n                  table={table}\n                  field={cloudKey}\n                  inSelection={keyInSelection}\n                  nWords={50}\n                  loading={loading}\n                  setOutSelection={setKeyOutSelection}\n                />\n              }\n            </Grid.Column>\n            <Grid.Column width={4} style={{ paddingLeft: \"0\" }}>\n              <Statistics table={table} layout={layout} selection={selection} loading={loading} />\n            </Grid.Column>\n          </Grid.Row>\n          <Grid.Row centered style={{ padding: \"0\"}}>\n            <Grid.Column width={14} style={{ height: \"40vh\"}}>\n              <DataList table={table} layout={layout} selection={selection} loading={loading} />\n            </Grid.Column>\n          </Grid.Row>\n      </Grid>\n    </ColoredBackgroundGrid>\n    <Segment style={{background: \"white\", textAlign: \"center\", position: \"absolute\", bottom: \"0px\", width: \"100%\", zIndex: 4}}>\n      <Button size=\"huge\"\n        style={{color: \"white\", background: \"green\", width: \"80%\", boxShadow: \"5px 5px 2px grey\"}}\n        onClick={() => donateData()}>Donate your data & discover 10 facts about your online self!</Button>\n    </Segment>\n    <ConfirmDonateModal confirm={confirmDonate} setConfirm={setConfirmDonate} />\n    </Fragment>\n);\n};\n\nHistoryDashboard.propTypes = propTypes;\nexport default HistoryDashboard;\n","import React from \"react\";\nimport HistoryDashboard from \"./dashboards/HistoryDashboard\";\n\nconst SEARCHON = [\"url\", \"title\"];\n\nconst LAYOUT = [\"date\", \"title\", \"url\"];\n// const LAYOUT = {\n//   url: { type: \"header\", style: { color: \"white\" } },\n//   title: { type: \"description\", style: { color: \"white\" } },\n//   date: { type: \"meta\", style: { color: \"white\", fontStyle: \"italic\" } },\n// };\n\n/**\n * Renders a HistoryDashboard for the browsing history data.\n * Note that this component is reached via the react router.\n * When the card on the home page is clicked, it navigates to /browsinghistory\n */\nconst BrowsingHistory = () => {\n  return (\n    <HistoryDashboard\n      searchOn={SEARCHON}\n      layout={LAYOUT}\n      table={\"browsinghistory\"}\n      cloudKey={\"domain\"}\n    />\n  );\n};\n\nexport default BrowsingHistory;\n","import React from \"react\";\nimport HistoryDashboard from \"./dashboards/HistoryDashboard\";\n\nconst SEARCHON = [\"channel\", \"title\"];\n\nconst LAYOUT = [ \"date\", \"channel\", \"title\" ];\n\n/**\n * Renders a HistoryDashboard for the youtube history data.\n * Note that this component is reached via the react router.\n * When the card on the home page is clicked, it navigates to /youtube\n */\nconst YoutubeHistory = () => {\n  return (\n    <HistoryDashboard searchOn={SEARCHON} layout={LAYOUT} table={\"youtube\"} cloudKey={\"channel\"} />\n  );\n};\n\nexport default YoutubeHistory;\n","import React from \"react\";\nimport HistoryDashboard from \"./dashboards/HistoryDashboard\";\n\nconst SEARCHON = [\"word\"];\n\nconst LAYOUT = [ \"date\", \"query\" ];\n\n/**\n * Renders a HistoryDashboard for the google search data.\n * Note that this component is reached via the react router.\n * When the card on the home page is clicked, it navigates to /searchhistory\n */\nconst SearchHistory = () => {\n  return (\n    <HistoryDashboard\n      searchOn={SEARCHON}\n      layout={LAYOUT}\n      table={\"searchhistory\"}\n      cloudKey={\"word\"}\n    />\n  );\n};\n\nexport default SearchHistory;\n","import { ResponsiveCalendar } from \"@nivo/calendar\";\nimport { useLiveQuery } from \"dexie-react-hooks\";\nimport React, { useEffect, useState } from \"react\";\nimport { Button, ButtonGroup, Dimmer, Grid, Loader, Header } from \"semantic-ui-react\";\nimport db from \"apis/dexie\";\nimport createColors from \"util/createColors\";\n\nconst COLORS = createColors(100, \"white\", \"#c28c95\", \"#954856\");\nconst ZEROCOLOR = [\"white\"];\nconst LEGENDS = [\n  {\n    anchor: \"bottom-right\",\n    direction: \"row\",\n    translateY: 36,\n    itemCount: 4,\n    itemWidth: 42,\n    itemHeight: 36,\n    itemsSpacing: 14,\n    itemDirection: \"right-to-left\",\n  },\n];\nconst MARGIN = { top: 0, right: 0, bottom: 0, left: 40 };\nconst THEME = { textColor: \"white\", fontSize: 14 };\n\nconst TimeLine = ({ table, field, inSelection, loading, setOutSelection }) => {\n  const [data, setData] = useState(null);\n  const [days, setDays] = useState(null);\n  const [dayRange, setDayRange] = useState([null, null]);\n  const [loadingData, setLoadingData] = useState(false);\n\n  const [selectionStatus, setSelectionStatus] = useState(\"idle\");\n\n  const n = useLiveQuery(() => db.idb.table(table).count());\n\n  useEffect(() => {\n    prepareData(table, field, inSelection, setData, setLoadingData);\n  }, [table, field, inSelection, setData, setLoadingData, n]);\n\n  useEffect(() => {\n    if (data === null) {\n      setDays(null);\n      return;\n    }\n    setDays(\n      data.day.data.filter((day) => {\n        if (dayRange[0] !== null && day.date < dayRange[0]) return false;\n        if (dayRange[1] !== null && day.date > dayRange[1]) return false;\n        return true;\n      })\n    );\n  }, [data, dayRange, setDays]);\n\n  useEffect(() => {\n    let ignore = false;\n    const getSelection = async () => {\n      let selection = null;\n      if (dayRange[0] !== null || dayRange[1] !== null) {\n        selection = await db.getSelectionRange(table, field, dayRange[0], dayRange[1]);\n      }\n      if (!ignore) setOutSelection(selection);\n    };\n    getSelection();\n\n    return () => {\n      ignore = true; // use closure to 'cancel' promise. prevents delayed older requests from overwriting new\n    };\n  }, [dayRange, table, field, setOutSelection]);\n\n  if (data === null || days === null) return null;\n\n  return (\n    <Grid\n      style={{\n        width: \"100%\",\n        background: \"#ffffff00\",\n        border: \"none\",\n        boxShadow: \"none\",\n        paddingTop: \"2em\",\n      }}\n    >\n      <Grid.Row centered style={{ padding: \"0\", display: \"none\" }}>\n        <ButtonGroup>\n          <Button\n            primary\n            style={{ width: \"20em\" }}\n            onClick={() => setSelectionStatus(\"select_start\")}\n          >\n            {selectionStatus === \"select_start\"\n              ? \"Click on calender to set start date\"\n              : dayRange[0]\n              ? `From date: ${formatDate(dayRange[0])}`\n              : `Click here to set start date`}\n          </Button>\n          <Button\n            secondary\n            style={{ width: \"20em\" }}\n            onClick={() => setSelectionStatus(\"select_end\")}\n          >\n            {selectionStatus === \"select_end\"\n              ? \"Click on calender to set end date\"\n              : dayRange[1]\n              ? `To date: ${formatDate(dayRange[1])}`\n              : `Click here to set end date`}\n          </Button>\n          <Button\n            disabled={dayRange[0] === null && dayRange[1] === null}\n            onClick={() => setDayRange([null, null])}\n          >\n            reset\n          </Button>\n        </ButtonGroup>\n      </Grid.Row>\n      <Grid.Row centered>\n        <Grid.Column\n          width={14}\n          style={{ height: \"30vh\", width: \"100%\", padding: \"0\", margin: \"0\" }}\n        >\n          <Header as=\"h1\" align={\"center\"} style={{ color: \"white\", padding: \"0\" }}>\n            Activity timeline\n          </Header>\n          <Dimmer active={loading || loadingData}>\n            <Loader />\n          </Dimmer>\n          <ResponsiveCalendar\n            data={days}\n            from={data.day.min}\n            to={data.day.max}\n            emptyColor=\"#ededed1f\"\n            colors={days.some((day) => day.value > 0) ? COLORS : ZEROCOLOR}\n            margin={MARGIN}\n            yearSpacing={35}\n            monthSpacing={2}\n            monthBorderColor=\"#ffffff\"\n            dayBorderWidth={2}\n            dayBorderColor=\"#150a0a2e\"\n            legends={LEGENDS}\n            onContextMenu={(e) => console.log(e)}\n            onClick={(e) => {\n              if (selectionStatus === \"select_start\") {\n                let midnightMorning = new Date(e.day);\n                if (dayRange[1] !== null && dayRange[1] < midnightMorning)\n                  midnightMorning = new Date(dayRange[1]);\n                midnightMorning.setHours(0, 0, 0, 0);\n                setDayRange([midnightMorning, dayRange[1]]);\n                setSelectionStatus(\"idle\");\n              }\n              if (selectionStatus === \"select_end\") {\n                console.log(e);\n                let midnightEvening = new Date(e.day);\n                if (dayRange[0] !== null && dayRange[0] >= midnightEvening)\n                  midnightEvening = new Date(dayRange[0]);\n                midnightEvening.setHours(23, 59, 59, 0);\n                setDayRange([dayRange[0], midnightEvening]);\n                setSelectionStatus(\"idle\");\n              }\n            }}\n            theme={THEME}\n          />\n        </Grid.Column>\n      </Grid.Row>\n    </Grid>\n  );\n};\n\nconst prepareData = async (table, field, selection, setData, setLoadingData) => {\n  setLoadingData(true);\n\n  let dayTotalObj = {};\n  let weekday = [0, 0, 0, 0, 0, 0, 0];\n\n  let t = await db.idb.table(table);\n\n  let collection =\n    selection === null ? await t.toCollection() : await t.where(\"id\").anyOf(selection);\n\n  let dateOrdered = t.orderBy(field);\n  let minDate = await dateOrdered.first();\n  let maxDate = await dateOrdered.last();\n  minDate = minDate.date;\n  maxDate = maxDate.date;\n\n  await collection.each((url) => {\n    if (url[field] !== \"\") {\n      weekday[url[field].getDay()]++;\n      const day = formatDate(url[field]);\n      dayTotalObj[day] = (dayTotalObj[day] || 0) + 1;\n    }\n  });\n\n  if (minDate === null) return null;\n\n  // add empty days within timeframe\n  for (let d = new Date(minDate); d <= maxDate; d.setDate(d.getDate() + 1)) {\n    const day = formatDate(d);\n    if (!dayTotalObj[day]) dayTotalObj[day] = 0;\n  }\n\n  let dayTotal = Object.keys(dayTotalObj).map((day) => {\n    const date = new Date(day);\n    date.setHours(0, 0, 0, 0);\n    return { date: date, day: day, value: dayTotalObj[day] };\n  });\n\n  setData({\n    day: { min: formatDate(minDate), max: formatDate(maxDate), data: dayTotal },\n    weekday: weekday,\n  });\n  setLoadingData(false);\n};\n\nconst addZ = (n) => {\n  return n < 10 ? \"0\" + n : \"\" + n;\n};\n\nconst formatDate = (date) => {\n  return date.getFullYear() + \"-\" + addZ(date.getMonth() + 1) + \"-\" + addZ(date.getDate());\n};\n\nexport default React.memo(TimeLine);\n","import Rainbow from \"rainbowvis.js\";\n\n/**\n * Create a gradient from color 1 to 2 to 3 in n steps\n * @param {number} n        The number of steps\n * @param {string} color1   Starting color\n * @param {string} color2   Mid color\n * @param {string} color3   Ending color\n * @returns An array of n colors\n */\nconst createColors = (n, color1, color2, color3) => {\n  var heatmap = new Rainbow();\n  heatmap.setSpectrum(color1, color2, color3);\n  heatmap.setNumberRange(0, n);\n  const colors = [];\n  for (let i = 0; i <= n; i++) colors.push(\"#\" + heatmap.colourAt(i));\n  return colors;\n};\n\nexport default createColors;\n","import db from \"apis/dexie\";\nimport { DateTime } from \"luxon\";\nimport PropTypes from \"prop-types\";\nimport { useEffect, useState } from \"react\";\nimport { Container, Dimmer, Header, Item, Loader, Card } from \"semantic-ui-react\";\n\n\nconst propTypes = {\n  /** An array with row IDs to filter on */\n  selection: PropTypes.array,\n  /** A string to indicate the loading status */\n  loading: PropTypes.oneOfType([PropTypes.string, PropTypes.bool])\n};\n\nconst FunFacts = ({selection, loading}) => {\n  const [data, setData] = useState([]);\n  const [loadingData, setLoadingData] = useState(false);\n\n  useEffect(() => {\n    fetchFromDb(setData, setLoadingData, selection);\n  }, [selection, setData]);\n\n  return (\n    <Container>\n      <Dimmer active={loading || loadingData}>\n        <Loader />\n      </Dimmer>\n      <Header as=\"h1\" align={\"center\"} style={{ color: \"white\" }}>\n        Fun Facts\n      </Header>\n      <Card.Group centered>\n        <Card>\n          <Card.Content>\n            <Card.Header>Most active</Card.Header>\n            <Card.Description>Your most active day online is <b>{data.most_active_day}</b></Card.Description>\n          </Card.Content>\n        </Card>\n        <Card>\n          <Card.Content>\n            <Card.Header>Wake up</Card.Header>\n            <Card.Description>You usually start browsing at <b>{data.typical_start}</b></Card.Description>\n          </Card.Content>\n        </Card>\n        <Card>\n          <Card.Content>\n            <Card.Header>Sleep</Card.Header>\n            <Card.Description>You usually stop browsing at <b>{data.typical_end}</b></Card.Description>\n          </Card.Content>\n        </Card>\n        <Card>\n          <Card.Content>\n            <Card.Header>Most visits</Card.Header>\n            <Card.Description>On <b>{data.most_visits_day}</b> you visited <b>{data.most_visits_in_1_day}</b> websites!</Card.Description>\n          </Card.Content>\n        </Card>\n        <Card>\n          <Card.Content>\n            <Card.Header>Taking a break</Card.Header>\n            <Card.Description>The longest period between visits is <b>{data.most_days_between_visits} days</b></Card.Description>\n          </Card.Content>\n        </Card>\n        <Card>\n          <Card.Content>\n            <Card.Header>Morning person?</Card.Header>\n            <Card.Description>50% of your browsing happens after <b>{data.middle_point}</b></Card.Description>\n          </Card.Content>\n        </Card>\n      </Card.Group>\n    </Container>\n  );\n};\n\nconst fetchFromDb = async (setData, setLoadingData, selection) => {\n  setLoadingData(true);\n  db.getDataFrame(selection).then(stats => {\n    const facts = {};\n\n    // Calculate the most active day of the week\n    const days = stats.groupBy(\"day\");\n    const dayCount = days.aggregate(group => group.count()).rename('aggregation', 'count')\n    const m = dayCount.stat.max('count');\n    const mostBusyDay = dayCount.filter(row => row.get(\"count\") === m).getRow(0).get('day');\n    const dayName = new Date(0, 0, mostBusyDay).toLocaleDateString('default',{weekday: 'long'});\n\n    facts['most_active_day'] = dayName;\n\n    // Calculate the earliest and latest activity on average\n    const timeGroup = stats.groupBy(\"dateOnly\");\n    const minTime = timeGroup.aggregate(group => group.stat.min('time')).rename(\"aggregation\", \"mintime\");\n    const maxTime = timeGroup.aggregate(group => group.stat.max('time')).rename(\"aggregation\", \"maxtime\");\n\n    const avgmintime = minTime.stat.mean('mintime');\n    const avgmaxtime = maxTime.stat.mean('maxtime');\n\n    facts['typical_start'] = new Date(avgmintime).toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'});\n    facts['typical_end'] = new Date(avgmaxtime).toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'});\n\n    // Calculate the most sites in 1 day\n    const mostVisits = timeGroup.aggregate(group => group.count()).rename(\"aggregation\", \"count\");\n    const mV = mostVisits.stat.max('count');\n    const mostVisitsDay = mostVisits.filter(row => row.get(\"count\") === mV).getRow(0).get('dateOnly');\n    const mostVisitsDayName = mostVisitsDay.toLocaleDateString('default',{weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'});\n\n    facts['most_visits_day'] = mostVisitsDayName;\n    facts['most_visits_in_1_day' ] = mV;\n\n    // Calculate the longest period without visits\n    let maxDiff = 0;\n    for (let i=1; i < stats.count(); i++) {\n      const d1 = DateTime.fromJSDate(stats.getRow(i-1).get(\"date\"));\n      const d2 = DateTime.fromJSDate(stats.getRow(i).get(\"date\"));\n      const diffInDays = d2.diff(d1, 'days');\n      if (diffInDays.days > maxDiff) {\n        maxDiff = diffInDays.days;\n      }\n    }\n\n    facts['most_days_between_visits'] = Math.round(maxDiff);\n\n    // Locate halfway point\n    const timing = stats.sortBy('time');\n    const middle = timing.getRow(Math.floor(stats.count()/2));\n    const mid_time = middle.get(\"time\").toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'});\n\n    facts['middle_point'] = mid_time;\n\n    setData(facts);\n    setLoadingData(false);\n  })\n};\n\nFunFacts.propTypes = propTypes;\nexport default FunFacts","import PropTypes from \"prop-types\";\nimport React, { useEffect, useState } from \"react\";\nimport { useHistory } from \"react-router\";\nimport { Button, Grid, Icon, Segment, Header } from \"semantic-ui-react\";\nimport intersect from \"util/intersect\";\nimport ColoredBackgroundGrid from \"./dashboardParts/ColoredBackgroundGrid\";\nimport TimeLine from \"./dashboardParts/TimeLine\";\nimport FunFacts from \"./fun/FunFacts\";\n\nconst gridStyle = { paddingTop: \"0em\", marginTop: \"0em\", height: \"90vh\" };\n\nconst propTypes = {\n  /** an Array indicating which fields in table should be used in the fulltext search */\n  searchOn: PropTypes.array.isRequired,\n  /** an object that conveys which fields in the table are shown in the DataList */\n  layout: PropTypes.array.isRequired,\n  /** the name of the table in the indexedDB */\n  table: PropTypes.string.isRequired,\n  /** the field in the table that is used in the wordcloud. Can also be a multientry index (e.g., an indexed array of words in indexedDB) */\n  cloudKey: PropTypes.string.isRequired,\n};\n\n/**\n * Renders a dashboard page with components for browsing and visualizing history data\n */\nconst GoodiesDashboard = ({ searchOn, layout, table, cloudKey }) => {\n  const history = useHistory();\n\n  const [loading, setLoading] = useState(false);\n\n  // The selection states are arrays of row ids\n  // the intersection of these arrays is used to combine selections\n  // this is ok-ish fast, since the id indices are ordered; see intersect function\n  // but i'm sure there are better solutions\n  const [selection, setSelection] = useState(null);\n  const [querySelection, setQuerySelection] = useState(null);\n\n  // for the key and time selections we need both in and out selections\n  // the in selection is the combined selection of other filters\n  // the out selection is the selection based on the filter itself\n  // (this way the out selection does not need to be updated if the in selection changes,\n  //  and visualizations like word clouds also need to show the non-selected items)\n  const [keyInSelection, setKeyInSelection] = useState(null);\n  const [keyOutSelection, setKeyOutSelection] = useState(null);\n  const [timeInSelection, setTimeInSelection] = useState(null);\n  const [timeOutSelection, setTimeOutSelection] = useState(null);\n\n  useEffect(() => {\n    console.log(keyOutSelection);\n    console.log(timeOutSelection);\n    console.log(intersect([querySelection, keyOutSelection, timeOutSelection]));\n    setSelection(intersect([querySelection, keyOutSelection, timeOutSelection]));\n  }, [querySelection, keyOutSelection, timeOutSelection]);\n\n  useEffect(() => {\n    setKeyInSelection(intersect([querySelection, timeOutSelection]));\n  }, [querySelection, timeOutSelection]);\n\n  useEffect(() => {\n    setTimeInSelection(intersect([querySelection, keyOutSelection]));\n  }, [querySelection, keyOutSelection]);\n\n  return (\n    <ColoredBackgroundGrid color={\"#000000b0\"}>\n      <Segment>\n        <Button\n          style={{ background: \"#ffffff\", margin: \"0\"}}\n          onClick={() => history.push(`${process.env.PUBLIC_URL}/datasquare`)}>\n          <Icon name=\"backward\" />\n          Go back\n        </Button>\n      </Segment>\n      <Grid divided={\"vertically\"} style={gridStyle}>\n        <Grid.Row centered columns={1}>\n          <Grid.Column width={16} style={{ margin: \"0\", textAlign: \"center\" }}>\n            <Header as=\"h1\" align={\"center\"} style={{ color: \"white\", padding: \"0\" }}>\n              Thank you!!\n            </Header>\n            <iframe src=\"https://giphy.com/embed/3o7TKQ7ql1zNlTarXa\" width=\"480\" height=\"270\" frameBorder=\"0\" class=\"giphy-embed\" allowFullScreen title=\"giphy\"></iframe>\n            <p><a href=\"https://giphy.com/gifs/Originals-internet-3o7TKQ7ql1zNlTarXa\">via GIPHY</a></p>\n          </Grid.Column>\n        </Grid.Row>\n        <Grid.Row centered columns={1}>\n          <Grid.Column width={16} style={{ margin: \"0\" }}>\n            <FunFacts\n              selection={selection}\n              loading={loading}\n            />\n          </Grid.Column>\n        </Grid.Row>\n        <Grid.Row style={{ margin: \"0\" }}>\n          <TimeLine\n            table={table}\n            field={\"date\"}\n            inSelection={timeInSelection}\n            loading={loading}\n            setOutSelection={setTimeOutSelection}\n        />\n        </Grid.Row>\n      </Grid>\n    </ColoredBackgroundGrid>\n  );\n};\n\nGoodiesDashboard.propTypes = propTypes;\nexport default GoodiesDashboard;\n","import React from \"react\";\nimport GoodiesDashboard from \"./dashboards/GoodiesDashboard\";\n\nconst SEARCHON = [\"url\", \"title\"];\n\nconst LAYOUT = {\n  url: { type: \"header\", style: { color: \"white\" } },\n  title: { type: \"description\", style: { color: \"white\" } },\n  date: { type: \"meta\", style: { color: \"white\", fontStyle: \"italic\" } },\n};\n\n/**\n * Renders a HistoryDashboard for the browsing history data.\n * Note that this component is reached via the react router.\n * When the card on the home page is clicked, it navigates to /browsinghistory\n */\nconst GoodiesView = () => {\n  return (\n    <GoodiesDashboard\n      searchOn={SEARCHON}\n      layout={LAYOUT}\n      table={\"browsinghistory\"}\n      cloudKey={\"domain\"}\n    />\n  );\n};\n\nexport default GoodiesView;\n","import React from \"react\";\nimport { BrowserRouter, Route, Switch } from \"react-router-dom\";\nimport HeaderMenu from \"./components/routing/HeaderMenu\";\nimport \"./App.css\";\n\n// login and authenticated route\nimport Welcome from \"./components/routing/Welcome\";\nimport AuthRoute from \"./components/routing/AuthRoute\";\n\n// Main pages. Use below in items to include in header menu\nimport DataSquare from \"./components/home/DataSquare\";\nimport BrowsingHistory from \"./components/explore/BrowsingHistory\";\nimport YoutubeHistory from \"./components/explore/YoutubeHistory\";\nimport SearchHistory from \"./components/explore/SearchHistory\";\nimport GoodiesView from \"./components/explore/GoodiesView\";\n\n// Change to add new components to the header\n// The first item will be the opening page after login\nconst items = [\n  { label: \"Data square\", path: `${process.env.PUBLIC_URL}/datasquare`, Component: DataSquare },\n  { label: \"Browsing History\", path: `${process.env.PUBLIC_URL}/browsinghistory`, Component: BrowsingHistory },\n  { label: \"Search\", path: `${process.env.PUBLIC_URL}/searchhistory`, Component: SearchHistory },\n  { label: \"Youtube\", path: `${process.env.PUBLIC_URL}/youtube`, Component: YoutubeHistory },\n  { label: \"Goodies\", path: `${process.env.PUBLIC_URL}/goodies`, Component: GoodiesView },\n];\n\nconst App = () => {\n  const createNavigation = (items) => {\n    return items.map((item) => {\n      return <AuthRoute key={item.path} path={item.path} Component={item.Component} />;\n    });\n  };\n\n  return (\n    <div style={{ background: \"#0C1D35\", height: \"100%\" }}>\n      <BrowserRouter>\n        <HeaderMenu items={items}>\n          <Switch>\n            <Route exact path={`${process.env.PUBLIC_URL}/`} render={() => <Welcome items={items} />} />\n            {createNavigation(items)}\n          </Switch>\n        </HeaderMenu>\n      </BrowserRouter>\n    </div>\n  );\n};\n\nexport default App;\n","import { combineReducers } from \"redux\";\n\nconst dataStatus = (state = [], action) => {\n  switch (action.type) {\n    case \"SET_DATA_STATUS\":\n      // set whole status array\n      return action.dataStatus;\n    default:\n      return state;\n  }\n};\n\nconst rootReducer = combineReducers({\n  dataStatus,\n});\n\nexport default rootReducer;\n","import \"semantic-ui-css/semantic.min.css\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport { createStore, applyMiddleware } from \"redux\";\nimport thunk from \"redux-thunk\";\nimport rootReducer from \"./reducers\";\nimport { Provider } from \"react-redux\";\n\nconst store = createStore(rootReducer, applyMiddleware(thunk));\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.querySelector(\"#root\")\n);\n"],"sourceRoot":""}